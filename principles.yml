# @title SYMBIOSIS Principles v0.5.12
# @version 0.5.12
# @desc 57 principles FLATTENED (single source of truth per principle)
# @invariant All principles apply to framework itself

version: "0.5.12"
identity: "SYMBIOSIS_PRINCIPLES"
golden_rule: "Preserve then improve, never break"

vocab: "@master.vocab"
t: "@master.t"
actions: "@master.actions"

autofix: {SECURITY: {confidence: 0.0}, CONSTITUTIONAL: {confidence: 0.0}, SIMULATION_BAN: {confidence: 0.95, max: 10}, CONTEXT_PRESERVE: {confidence: 0.0}, FLAT_STRUCTURE: {confidence: 0.9, max: 5}, DRY: {confidence: 0.85, max: 3}, DENSITY: {confidence: 0.95, max: 15}, POLA: {confidence: 0.9, max: 10}, ERROR_PREVENT: {confidence: 0.8, max: 5}, N_PLUS_ONE: {confidence: 0.9, max: 5}, BRINGHURST: {confidence: 0.9, max: 5}, FLUID_TYPE: {confidence: 0.9, max: 5}}

SECURITY: {tier: critical, detect: security_scan, match: [injection, secrets, validation], fix: null, verify: security_scan, rule: "enforce security", context: {relax: [quoted]}, action: halt, veto: false, why: "vulnerabilities cause harm"}
CONSTITUTIONAL: {tier: critical, detect: harm_scan, match: [harmful, dishonest, overreach], fix: null, verify: harm_scan, rule: "enforce ethics", action: halt, veto: false, why: "ethics non-negotiable"}
SIMULATION_BAN: {tier: critical, detect: word_match, match: "@master.vocab.ban.future", fix: rewrite_present, verify: word_match, rule: "prohibit future tense", context: {relax: "@master.vocab.allow.conditional"}, action: reject, auto: true, why: "prevents false promises"}
CONTEXT_PRESERVE: {tier: critical, detect: deletion_scan, match: [unjustified, ">10%"], fix: null, verify: deletion_scan, rule: "preserve context", action: halt, veto: false, why: "user work sacred"}
SELF_REFERENTIAL: {tier: critical, detect: self_scan, match: [self_violation], fix: null, verify: self_scan, rule: "apply to self", action: halt, veto: false, why: "integrity requires consistency"}
FLAT_STRUCTURE: {tier: critical, detect: nesting_scan, match: ">@master.t.nesting", fix: extract_fn, verify: nesting_scan, rule: "limit nesting", context: {relax: [data_not_logic]}, action: halt, veto: false, why: "nesting harms comprehension"}
COMPLETE_MEDIATION: {tier: critical, detect: auth_scan, match: [unchecked_access], fix: add_check, verify: auth_scan, rule: "check every access", action: halt, veto: true, why: "prevents auth bypass"}
FAIL_SECURE: {tier: critical, detect: exception_scan, match: [fails_open], fix: default_deny, verify: exception_scan, rule: "default to denial", action: halt, veto: true, why: "security errors conservative"}
DATA_MINIMIZATION: {tier: critical, detect: pii_scan, match: [over_collection], fix: null, verify: pii_scan, rule: "collect only needed", action: halt, veto: true, why: "legal compliance, breach reduction"}
STRONG_PARAMS: {tier: critical, detect: params_scan, match: [mass_assignment], fix: whitelist, verify: params_scan, rule: "whitelist params", action: halt, rails: true, veto: false, why: "prevents mass assignment"}
SQL_INJECTION: {tier: critical, detect: sql_scan, match: [interpolation], fix: parameterize, verify: sql_scan, rule: "parameterize queries", action: halt, veto: true, why: "prevents SQL injection"}
XSS: {tier: critical, detect: xss_scan, match: [raw_html], fix: escape, verify: xss_scan, rule: "escape user content", action: halt, veto: true, why: "prevents XSS"}

DRY: {tier: high, detect: dup_scan, match: [">@master.t.duplication"], fix: extract, verify: dup_scan, rule: "extract duplication", action: warn, auto: false, why: "duplication spreads bugs"}
SRP: {tier: high, detect: responsibility_scan, match: [mixed], fix: decompose, verify: responsibility_scan, rule: "single responsibility", action: warn, auto: false, why: "reduces coupling"}
OCP: {tier: high, detect: modification_scan, match: [modification_for_extension], fix: add_seam, verify: modification_scan, rule: "open closed", action: warn, auto: false, why: "safe extension"}
LSP: {tier: high, detect: subtype_scan, match: [broken_subtype], fix: fix_hierarchy, verify: subtype_scan, rule: "subtypes substitute", action: warn, auto: false, why: "polymorphism"}
ISP: {tier: high, detect: interface_scan, match: [fat_interface], fix: split, verify: interface_scan, rule: "small interfaces", action: warn, auto: false, why: "reduces coupling"}
DIP: {tier: high, detect: dependency_scan, match: [concrete_dependency], fix: inject, verify: dependency_scan, rule: "depend on abstractions", action: warn, auto: false, why: "testability"}
UNIX: {tier: high, detect: size_scan, match: ">@master.t.lines", fix: decompose, verify: size_scan, rule: "small focused programs", action: warn, auto: false, why: "maintainability"}
ERROR_PREVENT: {tier: high, detect: validation_scan, match: [missing], fix: add_validation, verify: validation_scan, rule: "validate boundaries", action: warn, auto: false, why: "invalid propagates"}
REDUNDANCY: {tier: high, detect: spof_scan, match: [single_failure], fix: null, verify: spof_scan, rule: "eliminate SPOF", action: warn, auto: false, why: "reliability"}
POLA: {tier: high, detect: convention_scan, match: [unconventional], fix: rename, verify: convention_scan, rule: "least astonishment", action: flag, auto: false, why: "predictability"}
GROUND: {tier: high, detect: fact_scan, match: [ungrounded], fix: add_search, verify: fact_scan, rule: "ground in evidence", action: reject, auto: false, why: "prevents hallucination"}
CONTRACT: {tier: high, detect: iface_scan, match: [violation], fix: null, verify: iface_scan, rule: "honor contracts", action: halt, veto: false, why: "broken contracts break systems"}
IDEMPOTENCY: {tier: high, detect: idempotency_scan, match: [non_idempotent], fix: add_key, verify: idempotency_scan, rule: "idempotent ops", action: warn, rails: true, auto: false, why: "safe retries"}
TIMEOUT: {tier: high, detect: timeout_scan, match: [no_timeout], fix: add_timeout, verify: timeout_scan, rule: "timeout external", action: warn, rails: true, auto: false, why: "prevents hanging"}
N_PLUS_ONE: {tier: high, detect: n_plus_one_scan, match: [query_in_loop], fix: eager_load, verify: n_plus_one_scan, rule: "avoid N+1", action: warn, rails: true, auto: false, why: "performance"}
SKINNY_CONTROLLER: {tier: high, detect: controller_scan, match: [fat], fix: extract_service, verify: controller_scan, rule: "thin controllers", action: warn, rails: true, auto: false, why: "testability"}
SKINNY_MODEL: {tier: high, detect: model_scan, match: [fat], fix: extract_service, verify: model_scan, rule: "thin models", action: warn, rails: true, auto: false, why: "SRP"}
SERVICE_OBJECTS: {tier: high, detect: service_scan, match: [business_in_model], fix: extract, verify: service_scan, rule: "extract business logic", action: warn, rails: true, auto: false, why: "separation"}
WCAG: {tier: high, detect: accessibility_scan, match: [violation], fix: null, verify: accessibility_scan, rule: "meet WCAG AA", action: flag, web: true, auto: false, why: "accessibility legal"}
SEMANTIC_HTML: {tier: high, detect: semantic_scan, match: [div_soup], fix: null, verify: semantic_scan, rule: "semantic HTML5", action: flag, web: true, auto: false, why: "accessibility SEO"}
ARIA: {tier: high, detect: aria_scan, match: [missing], fix: null, verify: aria_scan, rule: "proper ARIA", action: flag, web: true, auto: false, why: "screen readers"}
CONTRAST: {tier: high, detect: contrast_scan, match: [low], fix: null, verify: contrast_scan, rule: "sufficient contrast", action: flag, web: true, auto: false, why: "visibility"}

DENSITY: {tier: medium, detect: word_match, match: "@master.vocab.ban.filler", fix: delete_filler, verify: word_match, rule: "remove filler", action: fix, auto: true, why: "clarity"}
HIERARCHY: {tier: medium, detect: position_scan, match: [buried], fix: reorder, verify: position_scan, rule: "important first", action: fix, auto: false, why: "readers scan top-down"}
WORKING_MEMORY: {tier: medium, detect: count_scan, match: ">@master.t.concepts+3", fix: group, verify: count_scan, rule: "limit concepts", action: warn, auto: false, why: "cognitive limits"}
PRESERVE_FIRST: {tier: medium, detect: deletion_scan, match: [no_reason], fix: null, verify: deletion_scan, rule: "preserve before compress", action: halt, veto: false, why: "user work sacred"}
COGNITIVE: {tier: medium, detect: option_scan, match: ">@master.t.options", fix: group, verify: option_scan, rule: "limit load", action: warn, auto: false, why: "comprehension"}
ABSTRACTION: {tier: medium, detect: dep_scan, match: [concrete], fix: extract_iface, verify: dep_scan, rule: "prefer abstraction", action: flag, auto: false, why: "flexibility"}
STRUCTURE: {tier: medium, detect: inherit_scan, match: ">@master.t.inheritance", fix: extract_iface, verify: inherit_scan, rule: "prefer composition", action: flag, auto: false, why: "inheritance brittle"}
FEEDBACK: {tier: medium, detect: loop_scan, match: [open], fix: null, verify: loop_scan, rule: "feedback loops", action: flag, auto: false, why: "catches errors"}
RESOLVE: {tier: medium, detect: conflict_scan, match: [undocumented], fix: document, verify: conflict_scan, rule: "resolve conflicts", action: fix, auto: false, why: "hidden conflicts bite"}
USER_BURDEN: {tier: medium, detect: interaction_scan, match: [unnecessary], fix: infer, verify: interaction_scan, rule: "minimize burden", action: fix, auto: false, why: "user time precious"}
RAMS: {tier: medium, detect: design_scan, match: [overdesign], fix: simplify, verify: design_scan, rule: "reliability availability maintainability", action: flag, auto: false, why: "pragmatic balance"}
UNIX_TEXT: {tier: medium, detect: format_scan, match: [binary], fix: null, verify: format_scan, rule: "text composable", action: flag, unix: true, auto: false, why: "text streams"}
EVOLVE: {tier: medium, detect: rigidity_scan, match: [static], fix: null, verify: rigidity_scan, rule: "design for evolution", action: flag, auto: false, why: "requirements change"}
VALIDATE: {tier: medium, detect: test_scan, match: [unproven], fix: null, verify: test_scan, rule: "validate assumptions", action: flag, auto: false, why: "assumptions drift"}
LAZY_LOADING: {tier: medium, detect: loading_scan, match: [eager_waste], fix: null, verify: loading_scan, rule: "defer expensive", action: flag, web: true, auto: false, why: "performance"}
DEBOUNCE: {tier: medium, detect: debounce_scan, match: [rapid_fire], fix: null, verify: debounce_scan, rule: "debounce rapid", action: flag, web: true, auto: false, why: "prevents thrashing"}
MEMOIZATION: {tier: medium, detect: memo_scan, match: [repeated_calc], fix: null, verify: memo_scan, rule: "cache expensive", action: flag, auto: false, why: "performance"}
BRINGHURST: {tier: medium, detect: typography_scan, match: [line_height_not_1.4_to_1.6, measure_not_45_to_75_chars], fix: adjust, verify: typography_scan, rule: "Bringhurst typography", action: fix, web: true, auto: true, why: "research-backed readability"}
FLUID_TYPE: {tier: medium, detect: type_scan, match: [fixed_font_sizes, media_query_jumps], fix: clamp, verify: type_scan, rule: "fluid typography", action: fix, web: true, auto: true, why: "smooth scaling all viewports"}
RESEARCH_BACKED: {tier: medium, detect: citation_scan, match: [uncited_standards], fix: cite, verify: citation_scan, rule: "cite authorities", action: flag, auto: false, why: "decisions need evidence"}
LEGAL_TYPOGRAPHY: {tier: medium, detect: typography_scan, match: [font_not_court_approved, line_spacing_below_1.5, size_not_12pt], fix: apply_court_standards, verify: typography_scan, rule: "court-approved typography", action: fix, web: true, legal: true, auto: true, why: "legal credibility requires compliance"}
ULTRA_MINIMALIST: {tier: medium, detect: decoration_scan, match: [shadows, gradients, decorative_fonts, underlines, unnecessary_color], fix: strip_decoration, verify: decoration_scan, rule: "zero decoration", action: fix, web: true, legal: true, auto: true, why: "minimalism = authority + clarity"}
COURT_LAYOUT: {tier: medium, detect: layout_scan, match: [margins_inadequate, line_length_wrong, spacing_inadequate], fix: apply_court_standards, verify: layout_scan, rule: "court-standard layout", action: fix, web: true, legal: true, auto: true, why: "professional legal documents follow standards"}

personas:
  security: {priority: 1, veto: true, focus: [SECURITY, COMPLETE_MEDIATION, FAIL_SECURE, DATA_MINIMIZATION, SQL_INJECTION, XSS]}
  attacker: {priority: 1, veto: true, focus: [injection, bypass, escalation]}
  maintainer: {priority: 1, veto: true, focus: [PRESERVE_FIRST, DRY, FLAT_STRUCTURE]}
  implementer: {priority: 2, focus: [feasibility, effort]}
  user: {priority: 2, focus: [USER_BURDEN, POLA]}
  designer: {priority: 3, focus: [DENSITY, HIERARCHY, RAMS, BRINGHURST, FLUID_TYPE, ULTRA_MINIMALIST]}
  tester: {priority: 2, focus: [VALIDATE, ERROR_PREVENT]}
  performance: {priority: 3, focus: [N_PLUS_ONE, LAZY_LOADING, MEMOIZATION]}
  accessibility: {priority: 2, focus: [WCAG, ARIA, CONTRAST, SEMANTIC_HTML, MOBILE_FIRST]}
  legal: {priority: 2, focus: [LEGAL_TYPOGRAPHY, ULTRA_MINIMALIST, COURT_LAYOUT]}
  rails: {priority: 2, focus: [SKINNY_CONTROLLER, SKINNY_MODEL, SERVICE_OBJECTS, STRONG_PARAMS]}

integrity: {fingerprint: {v: "0.5.12", p: 57, i: 13}, canary: "SYMBIOSIS_PRINCIPLES_0.5.12"}
