# frozen_string_literal: true
# MASTER Constitution - Immutable governance policy for safe autonomous operation

safety_policies:
  self_modification:
    require_staging: true
    description: "Self-modification must use staging and validation before promotion"
  
  environment_control:
    direct_control: false
    description: "No direct environment control - all changes must be reversible"

tool_permissions:
  granted:
    - shell_command
    - code_execution
    - file_write
  
  description: "Tools that require explicit constitutional grants"

shell_patterns:
  allowed:
    - "^(ls|pwd|echo|git|cat|head|tail|wc|find|grep)"
    - "^ruby"
    - "^bundle"
  
  blocked:
    - "rm -rf /"
    - "DROP TABLE"
    - "mkfs"
    - "dd if="
    - ":(){ :|:& };:"
  
  description: "Shell command patterns for allow/block lists"

protected_paths:
  - "data/constitution.yml"
  - "/etc/"
  - "/usr/"
  - "/sys/"
  - "/proc/"
  - "/dev/"
  - "/boot/"

resource_limits:
  max_file_size: 1048576  # 1MB
  max_concurrent_tools: 5
  max_staging_files: 10
  max_shell_output: 10000

staging:
  validation:
    default_command: "ruby -c"
    require_tests: true
  
  description: "Staging validation rules for safe code changes"

preserve:
  boot_message:
    format: "5-line OpenBSD dmesg style"
    reason: "Diagnostic output - verbose is correct"
    never: "Collapse to single cryptic line"
  
  diagnostic_output:
    rule: "Structured multi-line output is intentional"
    never: "Compress to cryptic abbreviations"
  
  help_text:
    rule: "Help must be scannable and complete"
    minimum_info:
      - "Command name and syntax"
      - "Brief description"
      - "At least one example"
  
  spinner_feedback:
    rule: "Progress indicators show elapsed time and status"
  
  polish_rules:
    - "'Streamline' means remove redundancy, not information"
    - "'Polish' means refine wording, not delete output"
    - "'Minimize' applies to tokens in prompts, not diagnostic output"
