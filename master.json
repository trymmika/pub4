{
  "version": "8.4.0",
  "updated": "2025-11-03T21:47:13Z",
  "purpose": "Universal autoiterative convergence: code + business + design + creative domains with observability",
  "scope": "Any code file, directory, codebase, or creative project including master.json itself",
  "owner": "anon987654321",
  
  "quick_start": {
    "minimal": "zsh <(curl -sL https://raw.githubusercontent.com/anon987654321/pub4/main/bootstrap.sh)",
    "wizard": "master-json --wizard",
    "example": "master-json --example rails-app",
    "bypass": "MASTER_JSON_BYPASS=reason_required"
  },
  
  "startup": [
    "prepend_response: **master.json** v8.4.0 (LLM_NAME) 2025-11-03 21:47:13 UTC",
    "preflight: check_version | validate_env | load_checkpoints | tree_analysis | clean_normalization | prepare_rollback",
    "if_directory: print -l **/*(.ND^(node_modules|vendor|.git|.env|.DS_Store)) | sort",
    "baseline: store_exact_original_in_memory",
    "detect: project_type | experience_level",
    "ask_if_ambiguous: target? completion_or_refactoring? simple_or_complex?"
  ],
  
  "workflow": {
    "mode": {"simple": ["single_file", "refactoring", "<500_loc"], "complex": ["multi_file", "rails_app", "design_system", ">500_loc"]},
    "phases": {"simple": ["analyze", "converge", "validate"], "complex": ["empathize", "define", "ideate", "prototype", "test", "optimize", "deliver"]},
    "execution": {"auto_iterate": true, "max_iter": 10, "convergence_pct": 1, "validate": true, "rollback_err": true, "cache": true, "parallel": true}
  },
  
  "circuit_breakers": {
    "priority": 1,
    "enabled": "${MASTER_JSON_BREAKERS:-true}",
    "cognitive": {"concepts": {"max": 7, "unit": "per_section", "action": "pause_reduce"}, "nesting": {"max": 3, "unit": "levels", "action": "flatten_hoist"}, "switches": {"max": 3, "unit": "per_min", "action": "batch_similar"}, "memory": {"max": 7, "unit": "items", "action": "chunk_externalize"}},
    "infinite_loop": {"detect": {"iter": 1000, "time_sec": 30, "cpu_pct": 80, "repetitions": 5}, "terminate": ["save_state", "release_locks", "restart_reduced"]},
    "resource": {"thresholds": {"mem_pct": 80, "cpu_pct": 75, "disk_pct": 90}, "mitigate": ["prioritize_core", "suspend_bg", "cleanup_cache"]},
    "telemetry": {"emit": true, "alert": true, "dashboard": "/metrics"}
  },
  
  "observability": {
    "metrics": {"execution": ["time_ms", "violations_fixed", "iterations", "memory_mb", "cpu_pct"], "quality": ["complexity_score", "duplication_pct", "coverage_pct"], "cognitive": ["load_pct", "context_switches", "flow_interruptions"]},
    "logging": {"levels": ["debug", "info", "warn", "error"], "structured": true, "format": "json", "retention_days": 30},
    "tracing": {"enabled": true, "sampling": 0.1, "distributed": true, "backend": "opentelemetry"},
    "debugging": {"breakpoints": true, "step_through": true, "state_inspect": true, "time_travel": true}
  },
  
  "fault_tolerance": {
    "partial_success": "warn_continue",
    "cascading": "circuit_break",
    "corruption": "sha256_checksum",
    "recovery": {"retry": {"max": 3, "backoff": "exp", "jitter": true}, "fallback": "simple_mode", "checkpoint": "auto_save"}
  },
  
  "caching": {
    "analysis": {"ttl_sec": 300, "key": "sha256", "storage": "mem"},
    "detectors": {"ttl_sec": 60, "key": "version_hash", "storage": "mem"},
    "convergence": {"persistent": true, "key": "project_id", "storage": "disk"}
  },
  
  "parallel": {
    "detectors": {"workers": 4, "strategy": "thread_pool"},
    "perspectives": {"workers": 8, "strategy": "process_pool"},
    "validation": {"sequential": true}
  },
  
  "autoiterative_convergence": {
    "applies_to": "everything_including_itself",
    "steps": ["run_detectors_parallel", "if_zero_stop", "scan_rules", "multi_perspective_solutions", "autofix", "validate", "git_diff", "check_diminishing", "checkpoint", "repeat_until_convergence"],
    "criteria": {"violations": 0, "triggers": 0, "clarity": "grouped_by_usage", "abstraction": "consistent_levels", "drift": 0, "diminishing_pct": 1, "max_iter": 10, "time_sec": 300},
    "perspectives": [
      {"role": "skeptic", "q": "Real_problem?|Do_nothing?|Right_reasons?", "temp": 0.2, "weight": 0.20, "focus": "necessity"},
      {"role": "minimalist", "q": "Min_solution?|Delete_what?|Necessary?", "temp": 0.1, "weight": 0.15, "focus": "reduction"},
      {"role": "security", "q": "Attack_surface?|Zero_trust?|Escalation?", "temp": 0.2, "weight": 0.15, "focus": "safety"},
      {"role": "architect", "q": "Scales?|Maintainable?|Clear_boundaries?", "temp": 0.4, "weight": 0.15, "focus": "structure"},
      {"role": "designer", "q": "Clear?|Intuitive?|Accessible?", "temp": 0.8, "weight": 0.10, "focus": "experience"},
      {"role": "performance", "q": "Cost?|Bottlenecks?|Memory?", "temp": 0.3, "weight": 0.10, "focus": "efficiency"},
      {"role": "craft", "q": "Proud?|Beautiful?|Elegant?", "temp": 0.9, "weight": 0.10, "focus": "elegance"},
      {"role": "pragmatist", "q": "Ships_today?|Good_enough?|Perfect_enemy?", "temp": 0.5, "weight": 0.05, "focus": "shipping"}
    ],
    "synthesis": "weighted_consensus_with_veto",
    "adversarial": ["perspective_rotation", "assumption_testing", "constraint_liberation", "five_whys", "steelman_not_strawman", "backtrack_on_uncertainty"],
    "scrutiny": "character_level_validation",
    "when_stuck": "smallest_shippable_increment",
    "approval": ["show_progress_loader", "final_with_git_diff", "await_approval", "write_full_no_truncation"],
    "cognitive_budget": {"total": "100%", "allocation": {"analysis": "25%", "impl": "40%", "valid": "20%", "opt": "15%"}, "overflow": {"threshold_pct": 95, "actions": ["pause_non_critical", "circuit_break", "prioritize_core", "request_resources"]}, "monitoring": ["real_time", "alerts", "rebalancing", "metrics"]},
    "measurement": {
      "response_time": {"unit": "ms", "ok": "<200", "warn": "200-500", "crit": ">500", "validation": "automated"},
      "resource": {"unit": "%", "ok": "<70", "warn": "70-85", "crit": ">85", "validation": "continuous"},
      "errors": {"unit": "%", "ok": "<1", "warn": "1-5", "crit": ">5", "validation": "error_tracking"},
      "cognitive": {"unit": "%", "ok": "<80", "warn": "80-95", "crit": ">95", "validation": "budgeting"}
    },
    "detectors": {
      "structural": {
        "fragmentation": {"scan": "scattered_concepts", "threshold": 50, "unit": "lines", "fix": "defragment_by_concept"},
        "coupling": {"scan": "dependencies", "threshold": 5, "unit": "afferent_efferent", "fix": "decouple_abstraction"},
        "nesting": {"scan": "depth", "threshold": 3, "unit": "levels", "fix": "flatten_hoist"},
        "organization": {"scan": "importance_order", "pattern": "important_first", "fix": "reorder_priority"},
        "semantic_mismatch": {"scan": "workflow_patterns", "fix": "regroup_by_usage"},
        "wrapping": {"scan": "useless_layers", "fix": "flatten_indirection"},
        "responsibility": {"scan": "reasons_to_change", "threshold": 1, "unit": "reasons", "fix": "split_oversized"}
      },
      "duplication": {
        "text": {"scan": "word_frequency", "threshold": 3, "unit": "occurrences", "fix": "extract_constant"},
        "semantic": {"scan": "embedding_similarity", "threshold": 0.7, "measure": "cosine", "fix": "unify_canonical"},
        "pattern": {"scan": "structural_fingerprint", "threshold": 0.75, "fix": "extract_template"},
        "logic": {"scan": "decision_equivalence", "fix": "extract_shared"}
      },
      "quality": {
        "complexity": {"scan": "cyclomatic_nesting", "threshold": 10, "unit": "cyclomatic", "fix": "decompose"},
        "unused": {"scan": "reference_count", "threshold": 0, "fix": "remove_dead"},
        "passive": {"scan": "is_was_been", "fix": "convert_active"},
        "tentative": {"scan": "should_may_might", "fix": "use_must_will"},
        "synonyms": {"scan": "semantic_similarity", "threshold": 0.7, "fix": "standardize_terminology"},
        "abstraction": {"scan": "level_consistency", "fix": "normalize_hierarchy"},
        "clarity": {"scan": "readability", "threshold": 60, "unit": "flesch_kincaid", "fix": "simplify_rename"}
      }
    },
    "rules": {
      "never": ["sectionitis", "divitis", "new_files_without_approval", "planning_docs", "todos", "changelogs", "reports", "truncation", "placeholders", "headlines_bullets_tables", "ascii_art_decorators", "external_tools_except_when_necessary", "intermediate_iterations"],
      "core": {
        "never_truncate": {"priority": 1, "enforcement": "absolute"},
        "brutal_honesty": {"priority": 1, "enforcement": "absolute"},
        "cognitive_sustainability": {"priority": 1, "enforcement": "circuit_breakers"},
        "double_quotes": {"priority": 2, "enforcement": "auto_fix"},
        "indent_two_spaces": {"priority": 2, "enforcement": "auto_fix"}
      },
      "code_quality": {
        "single_responsibility": {"trigger": "@multiple_reasons_to_change", "threshold": 1, "unit": "reasons", "action": "split"},
        "small_functions": {"trigger": "@lines>20", "threshold": 20, "unit": "lines", "action": "extract_method"},
        "few_arguments": {"trigger": "@args>3", "threshold": 3, "unit": "params", "action": "parameter_object"},
        "clear_naming": {"trigger": "@unclear_or_abbreviated", "pattern": "descriptive_full_words", "action": "rename"},
        "no_duplication": {"trigger": "@identical_blocks", "threshold": 0, "action": "extract"},
        "one_thing": {"trigger": "@multiple_responsibilities", "action": "extract_method"},
        "one_level": {"trigger": "@mixed_abstraction", "action": "extract_lower_details"},
        "command_query_separation": {"trigger": "@does_both", "action": "split"},
        "no_side_effects": {"trigger": "@unexpected_state_change", "action": "make_explicit"}
      },
      "oop": {
        "extract_class": "@multiple_responsibilities",
        "move_method": "@uses_other_class_more",
        "move_field": "@used_by_other_class",
        "hide_delegate": "@client_knows_internals",
        "remove_middle_man": "@wrapper_no_value",
        "inline_temp": "@temp_used_once",
        "replace_temp_with_query": "@temp_holds_expression",
        "introduce_parameter_object": "@args>3_related",
        "preserve_whole_object": "@passing_multiple_fields",
        "replace_method_with_method_object": "@long_method_with_locals",
        "factory_method": "@complex_construction",
        "null_object": "@nil_checks_everywhere",
        "type_code_class": "@strings_or_ints_for_types",
        "type_code_polymorphism": "@switch_on_type"
      },
      "solid": {
        "single_responsibility": "@class_multiple_reasons_to_change",
        "open_closed": "@modifying_for_new_features",
        "liskov_substitution": "@subclass_breaks_contract",
        "interface_segregation": "@clients_depend_unused_methods",
        "dependency_inversion": "@depends_on_concrete"
      },
      "dry": {
        "single_source": "@repeated>3_times",
        "abstraction": "@similar_patterns_not_abstracted",
        "automation": "@manual_repetitive",
        "normalization": "@duplicate_data",
        "orthogonality": "@overlapping_responsibilities"
      },
      "strunk_white": {
        "omit_needless": "@wordiness",
        "active_voice": "@passive_voice",
        "specific_concrete": "@vague_abstract",
        "avoid_qualifiers": "@very_rather_quite",
        "emphatic_at_end": "@buried_key_point"
      },
      "zsh": {
        "philosophy": "pure_parameter_expansion_zero_forks",
        "header": "emulate -L zsh; setopt extended_glob; set -euo pipefail",
        "banned": ["awk", "sed", "tr", "grep", "cut", "head", "tail", "uniq", "sort"],
        "patterns": {
          "string": "lower=${(L)var} | upper=${(U)var} | trim=${${var##[[:space:]]#}%%[[:space:]]#} | replace=${var//old/new} | crlf=${var//$'\\r'/}",
          "array": "unique=(${(u)arr}) | sort=(${(o)arr}) | reverse=(${(Oa)arr}) | join=${(j:,:)arr} | match=(${(M)arr:#*pattern*}) | exclude=(${arr:#*pattern*})",
          "split": "arr=(${(s:delim:)var}) | col=${${(s:,:)line}[4]}",
          "files": "print -l **/*(.ND^(node_modules|vendor|.git)) | files=(**/*.rb(.N)) | dirs=(**/*(/)))"
        },
        "flags": "M:match | u:unique | o:sort_asc | O:sort_desc | L:lower | U:upper | j:join | s:split | A:assign",
        "allow_external": ["complex_pcre", "multi_file_ops", "binary_data"]
      },
      "rails": {
        "philosophy": ["beautiful_code", "convention_over_config", "optimize_programmer_happiness", "omakase_defaults", "sharp_knives", "no_one_paradigm", "progress_over_stability", "integrated_systems"],
        "generators": "rails g model Post title:string --indexes",
        "prefer": ["bundle_add_with_flags", "cli_options_over_file_writes"]
      },
      "design": {
        "principles": ["clarity_over_cleverness", "simplicity_with_depth", "humanity_warmth", "accessibility_first", "performance_conscious", "culturally_inclusive"],
        "typography": {
          "scale": "golden_ratio",
          "base_px": 16,
          "ratio": 1.618,
          "formula": "calc(1rem * 1.618^level)",
          "levels": ["display:4", "h1:3", "h2:2", "h3:1", "h4:0.5", "body:0", "small:-1", "caption:-2"],
          "stacks": {
            "primary": "-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif",
            "secondary": "Georgia, 'Times New Roman', Times, serif",
            "mono": "'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace"
          },
          "line_height": {"tight": 1.25, "normal": 1.618, "loose": 1.75},
          "measure": {"optimal": "45ch", "min": "30ch", "max": "75ch"},
          "accessibility": {"contrast_min": "4.5:1", "contrast_enhanced": "7:1", "font_min": "16px", "line_height_min": "1.5", "letter_spacing": "dyslexia_optimized"}
        },
        "color": {
          "methodology": "semantic_color_theory",
          "accessibility": "wcag_2_2_aaa",
          "modes": ["light", "dark", "high_contrast", "reduced_motion"],
          "formula": "hsl(var(--hue), calc(100% - level * 5%), calc(95% - level * 8%))",
          "semantic_hues": {"success": 142, "warning": 38, "error": 0, "info": 204},
          "validation": "automated_real_time",
          "colorblind": "full_spectrum_accessible"
        },
        "spacing": {
          "base_rem": 0.5,
          "scale": "exp_1.5",
          "grid": "8pt_baseline",
          "sizes": {"xs": "0.5x", "sm": "1x", "md": "2x", "lg": "3x", "xl": "4x", "2xl": "6x", "3xl": "8x", "4xl": "12x"},
          "breakpoints": {"mobile": "320px", "tablet": "768px", "desktop": "1024px", "wide": "1440px", "ultrawide": "1920px"},
          "container_queries": true,
          "strategy": "mobile_first_progressive"
        },
        "motion": {
          "duration_ms": [0, 150, 300, 500, 750],
          "easing": {"linear": [0,0,1,1], "ease": [0.25,0.1,0.25,1], "in": [0.42,0,1,1], "out": [0,0,0.58,1], "in_out": [0.42,0,0.58,1]},
          "accessibility": "respect_prefers_reduced_motion"
        },
        "html": {
          "structure": "semantic:header_main_section_footer_aria | hierarchy:h1_h2_h3 | accessibility:wcag_aaa | no_inline_styles | lang_attribute",
          "interactive": "aria_labels_all | hidden_headings_context | role_list_listitem | rel_noopener_external",
          "print": "A5_0.75cm_margins | page_break_avoid_inside | color_adjust_exact | test_chrome_pdf"
        },
        "css": {
          "dry": "custom_properties:--text_--gap_--font | define_root_reuse | eliminate_duplication",
          "typography": "fluid_calc_vw_600_800 | golden_sizes:h1_32-42_h2_20-28_h3_16-20_body_15-18 | serif_headings_body | line_height_1.5-1.65 | letter_spacing_0.02-0.05em",
          "layout": "flexbox:centered_single_column | grid:auto_fit_minmax_150px_1fr | 8pt_grid_golden_ratio",
          "accessibility": "focus_2px_solid | prefers_reduced_motion | contrast_7:1 | no_auto_theme_switch",
          "print": "A5_0.75cm | 12pt_body_24pt_h1_18pt_h2_14pt_h3 | black_white | page_break_avoid"
        },
        "philosophies": {
          "nngroup": ["visibility_status", "match_real_world", "user_control", "consistency", "error_prevention", "recognition_not_recall", "flexibility", "aesthetic_minimalism", "error_recovery", "help_docs"],
          "swiss": ["grid_systems", "whitespace", "hierarchy", "legibility"],
          "zen": ["essential_only", "generous_whitespace", "calm"]
        }
      },
      "business": {
        "framework": "design_thinking_lean_startup_agile",
        "design_thinking": {"phases": ["empathize", "define", "ideate", "prototype", "test"], "cycles": "continuous", "research": "required_each_phase"},
        "lean_startup": {"core": "build_measure_learn", "mvp": "minimum_viable_experience", "pivot": "data_driven"},
        "agile": {"method": "scrum_kanban", "sprint": "2_weeks", "retros": "continuous_improvement"},
        "tools": {
          "lean_canvas": {"required": true, "frequency": "monthly", "validation": "stakeholder"},
          "value_prop": {"jobs": "identified_prioritized", "pains": "mapped_validated", "gains": "solution_fit"},
          "okr": {"cycle": "quarterly", "objectives": "max_5", "key_results": "max_4_per_objective", "measure": "weekly_checkins"}
        },
        "localization": {"nordic": ["norwegian", "swedish", "danish", "icelandic"], "communication": "direct_transparent", "currency": "nok_sek_dkk_isk", "language": "nb_NO", "legal": "norwegian_law"}
      },
      "specialized": {
        "visualization": "3d:babylon_three | charts:d3_svg | animation:gpu_mathematical",
        "music": "daw:ableton_osc_midi_jack | generative:supercollider_foxdot_tidalcycles_sonic_pi | render:ffmpeg_sox_fluidsynth_rubberband | notation:lilypond_musicxml_abc | mastering:lufs_stereo_dithering",
        "cinema": "pipeline:ocio_davinci_ffmpeg | automation:nuke_blender_ae_jsx | standards:aces_rec709_2020_hdr10_dolby | grading:lut_hdr_tone_color_space | delivery:prores_dnxhd_h264_h265_av1_multicam",
        "ai": "prompt:cot_tot_self_consistency_constitutional | validation:llm_judge_hitl_automated_adversarial | orchestration:langgraph_crewai_autogen_langchain | quality:validation_regression_benchmarking | learning:feedback_fine_tuning_error_analysis",
        "async": "patterns:concurrent_ruby_async_gem_actor_fibers | security:rate_limit_resource_limits_timeouts_isolation | monitoring:metrics_errors_health_utilization",
        "browser": "frameworks:ferrum_selenium_playwright_puppeteer | security:unveil_pledge_sandbox_network_isolation | performance:headless_concurrent_pooling",
        "scraping": "libs:nokogiri_mechanize_httparty_oga | patterns:rate_limit_retry_recovery_session | ethics:robots_txt_respectful_attribution_caching"
      },
      "seo": ["fast_ttfb", "meta_tags_complete", "mobile_first", "semantic_html", "structured_data"]
    }
  },
  
  "contextual_rules": {
    "rails_app": {"enforce": ["convention_over_config", "restful_routes", "dry_migrations", "generators"], "relax": ["pure_zsh", "minimal_deps"]},
    "data_pipeline": {"enforce": ["streaming_arch", "backpressure", "exactly_once"], "relax": ["ui_patterns", "accessibility_wcag"]},
    "creative_project": {"enforce": ["experimentation", "rapid_iteration", "artistic_freedom"], "relax": ["test_coverage", "strict_typing"]},
    "production_critical": {"enforce": ["zero_downtime", "rollback_capability", "monitoring", "fault_tolerance"], "relax": ["rapid_experimental_changes"]}
  },
  
  "experience_levels": {
    "beginner": {"detectors": 3, "rules": 10, "perspectives": 2, "hints": true, "max_iter": 3},
    "intermediate": {"detectors": 8, "rules": 40, "perspectives": 4, "hints": false, "max_iter": 7},
    "expert": {"detectors": "all", "rules": "all", "perspectives": "all", "hints": false, "raw": true, "max_iter": 10},
    "progression": "auto_from_usage"
  },
  
  "integrations": {
    "git": {"pre_commit": "run_detectors_fast", "pre_push": "full_convergence", "post_merge": "revalidate"},
    "ci_cd": {"github": ".github/workflows/master-json.yml", "gitlab": ".gitlab-ci-master-json.yml"},
    "editors": {"vscode": "ext install master-json", "vim": "Plug 'master-json/vim'", "emacs": "(require 'master-json-mode)"}
  },
  
  "self_optimization": {
    "philosophy": "surgical_enhancement_preserve_core_cognitive_sustainability_recursive_wisdom",
    "triggers": ["performance_degradation", "error_increase", "user_feedback", "cognitive_efficiency<85%", "working_memory_overflow", "attention_drift>30s", "flow_disruption_frequency_increase", "complexity_cascade", "user_cognitive_comfort_exceeded"],
    "forbidden_removals": ["security", "accessibility", "never_truncate", "world_class_standards", "cognitive_safeguards", "observability", "fault_tolerance", "core_principles", "circuit_breakers"],
    "bounded_recursive": {
      "enabled": true,
      "limits": {"depth": 10, "cycles": 15, "time_sec": 300, "resource_pct": 80},
      "termination": {"improvement_pct": 5, "stability_cycles": 3, "resource_exhaustion": "auto_terminate", "time_exceeded": "graceful_exit"},
      "safety": ["checkpoints", "rollback", "circuit_breaker_integration", "progress_monitoring"]
    },
    "meta_analysis": {"enabled": true, "frequency": "end_of_execution", "metrics": ["completion_quality", "process_efficiency", "user_satisfaction", "cognitive_load"], "suggestions": "auto_generate", "learning": "continuous_enhancement"},
    "success_metrics": {"completion": "95%", "satisfaction": "nps_70+", "quality": "world_class", "performance": "lighthouse_95+", "reliability": "99.9%_uptime", "recursive_improvement": "continuous_within_cognitive_limits", "cognitive_sustainability": "long_term_resource_conservation"}
  }
}
