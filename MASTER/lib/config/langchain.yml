# Langchain-rb Integration Patterns
# Safe tool usage and sandbox requirements
---
version: 1
langchain:
  enabled: false  # Opt-in for langchain integration
  safe_mode: true
  autonomous_mode: false  # Requires explicit user approval
  
safe_tools:
  filesystem:
    - read_file
    - list_directory
    - file_exists
    - file_stats
  prohibited:
    - delete_file
    - write_file
    - execute_command
    - network_request
    
  web:
    - fetch_url
    - parse_html
    - extract_text
  prohibited:
    - submit_form
    - click_button
    - execute_javascript
    
  database:
    - read_only_query
    - count_records
    - aggregate_stats
  prohibited:
    - insert_record
    - update_record
    - delete_record
    - create_table
    - drop_table

sandbox_requirements:
  filesystem:
    chroot: /tmp/langchain_sandbox
    readonly_paths:
      - /lib
      - /usr/lib
      - /home/runner/work/pub4/pub4/lib
    writable_paths:
      - /tmp/langchain_sandbox/work
    max_file_size: 10485760  # 10MB
    
  network:
    allowed_domains:
      - api.openai.com
      - api.anthropic.com
      - openrouter.ai
    blocked_domains:
      - localhost
      - 127.0.0.1
      - 0.0.0.0
    max_request_size: 1048576  # 1MB
    timeout: 30
    
  resources:
    max_memory: 536870912  # 512MB
    max_cpu_time: 60  # seconds
    max_processes: 1

autonomous_mode_guards:
  enabled: true
  requirements:
    - user_approval: true
    - session_timeout: 3600  # 1 hour
    - action_limit: 100
    - cost_limit: 10.0  # dollars
    
  prohibited_actions:
    - system_modification
    - credential_access
    - data_deletion
    - network_attack
    - privilege_escalation
    
  audit:
    log_all_actions: true
    log_dir: var/logs/langchain
    retention_days: 30

integration_patterns:
  tool_chaining:
    enabled: true
    max_chain_length: 5
    verify_each_step: true
    
  error_handling:
    retry_count: 3
    retry_delay: 1
    fallback_to_safe_mode: true
    
  rate_limiting:
    enabled: true
    requests_per_minute: 60
    burst_size: 10
