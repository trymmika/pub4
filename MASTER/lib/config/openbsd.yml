# OpenBSD configuration validation rules
---
man_base_url: https://man.openbsd.org
cache_ttl: 86400

configs:
  pf.conf:
    daemon: pf
    man: pf.conf.5
    required:
      - set skip on lo
    warnings:
      - pattern: pass all
        message: Overly permissive

  httpd.conf:
    daemon: httpd
    man: httpd.conf.5
    required:
      - server

  smtpd.conf:
    daemon: smtpd
    man: smtpd.conf.5
    required:
      - listen on
      - action
      - match
    warnings:
      - pattern: match from any
        message: Open relay risk

  nsd.conf:
    daemon: nsd
    man: nsd.conf.5
    required:
      - "server:"
      - "zone:"
    warnings:
      - pattern: rrl-size
        absent_message: Missing RRL config for DDoS protection
      - pattern: hide-version
        absent_message: Consider hide-version yes

  relayd.conf:
    daemon: relayd
    man: relayd.conf.5
    required:
      - relay

  acme-client.conf:
    daemon: acme-client
    man: acme-client.conf.5
    required:
      - authority
      - domain

  doas.conf:
    daemon: doas
    man: doas.conf.5
    required:
      - permit
    warnings:
      - pattern: nopass
        message: Allows passwordless escalation

  sshd_config:
    daemon: sshd
    man: sshd_config.5
    warnings:
      - pattern: PermitRootLogin yes
        message: Security risk
      - pattern: PasswordAuthentication yes
        message: Consider key-only auth

  ntpd.conf:
    daemon: ntpd
    man: ntpd.conf.5
    required:
      - server

  unbound.conf:
    daemon: unbound
    man: unbound.conf.5
    required:
      - "server:"
