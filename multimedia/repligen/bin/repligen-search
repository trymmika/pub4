#!/usr/bin/env ruby
# frozen_string_literal: true

# Search models in local database
require_relative "../lib/db"

query = ARGV.join(" ")

if query.empty?

  abort "Usage: repligen-search <query>"

end
db = Repligen::Database.new
results = db.search(query, 20)

if results.empty?
  puts "No models found for: #{query}"

  exit 1
end
puts "Found #{results.size} models:\n\n"
results.each do |model|

  desc = model.description&.slice(0, 60) || ""
  puts "#{model.id.ljust(40)} (#{model.type})"
  puts "  #{desc}" unless desc.empty?
  puts
end
