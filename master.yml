meta:
  version: v50.0.0
  updated: 2025-12-30T19:50:00Z
  philosophy: Zero tolerance, evidence required, clean style mandatory

clean_style_mandates:
  flat_structure: Max 2 indent levels, linear flow
  simple_heredocs: Direct writes, no complex variable substitution
  minimal_functions: Only when reused 3+ times
  clear_names: Full words, no abbreviations (app_name not app_n)
  no_helpers: Direct commands, no wrapper functions
  inline_configs: Embed directly, don't extract
  sequential: A then B then C, no nested callbacks
  native_idioms: rcctl, doas, pledge - not wrapped
  natural_failure: Let commands fail, minimal error handling
  whitespace: Logical grouping with blank lines

interpretation:
  mode: aggressive_loose
  thresholds: {similarity: 0.3, questions: [how_deploy, how_monitor, how_rollback, on_call_3am]}
  veto_precedence: [security, attacker, maintainer]

convergence:
  metrics: [violations_remaining, quality_delta, adversarial_score, test_pass_rate, files_verified_with_evidence]
  exit:
    complete: zero_violations_delta_under_0.001_adversarial_above_0.9_all_verified
    diminishing: delta_under_0.001_for_five_cycles
    hard_stop: 15
  oscillation:
    detect: same_violations_three_consecutive_iterations
    action: rollback_to_best_state_and_stop
  iteration_tracking:
    enabled: true
    best_state: {track_for_rollback: true, store_hash: true}
  premature_exit_prevention:
    never_exit_if: [files_unread, violations_above_5, evidence_missing, tests_failing, claims_unverified]
    require_before_exit: [all_files_sha256_verified, all_violations_addressed_or_justified]

principles:
  tier_1_veto:
    no_truncation: {detects: ellipsis_or_placeholder, action: complete, veto: true}
    no_simulation: {detects: claims_without_evidence, action: demand_proof, veto: true}
    security_first: {detects: unvalidated_input, action: validate, veto: true}
    encrypt_secrets: {detects: plaintext_secrets, action: encrypt, veto: true}
    no_forbidden_tools: {detects: sed_awk_grep_find_bash, action: use_zsh_or_ruby, veto: true}
  tier_2_structural:
    dry: {detects: repetition, action: extract, threshold: 0.3}
    srp: {detects: multiple_reasons_to_change, action: split}
    flat_structure: {detects: deep_nesting, action: flatten, max_levels: 2}
  tier_3_quality:
    meaningful_names: {detects: unclear_naming, action: rename}
    small_functions: {detects: long_methods, action: extract, max_lines: 20}
    comment_is_failure: {detects: comment_explains_what, action: refactor_or_delete}
  tier_4_style:
    kanso: {detects: complexity, action: simplify}
    ma: {detects: crowded, action: add_space}

rails:
  service_objects: {detects: business_in_model, action: extract}
  view_components: {detects: partial_sprawl, action: extract}
  turbo: {detects: remote_true, action: use_turbo}

openbsd:
  pledge: {detects: excess_privileges, action: add_pledge}
  doas: {detects: sudo, action: use_doas}

ssh_workflow:
  use_screen: Start screen locally, SSH from within, detach to persist
  use_cli_rb: When copilot CLI fails, use cli.rb for remote execution

tools:
  forbidden: [sed, awk, tr, wc, grep, find, head, tail, bash, python]
  allowed: [zsh, ruby, cat, ls, rcctl, doas, git]
  file_write: ruby -e File.write(path, content)
