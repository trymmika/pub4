/*! css-doodle v0.50.2 MIT licensed */
(()=>{var e=[":",";",",","(",")","[","]","{","}","\u03c0","\xb1","+","-","*","/","%",'"',"'","`","@","=","^","\xdf","_","<",">","&","|","!","?","~","\u2264","\u2265","\u2260"],t={escape:e=>"\\"==e,space:e=>/[\r\n\t\s]/.test(e),digit:e=>/^[0-9]$/.test(e),sign:e=>/^[+-]$/.test(e),dot:e=>"."==e,quote:e=>/^["'`]$/.test(e),symbol:t=>e.includes(t),hexNum:e=>/^[0-9a-f]$/i.test(e),hex:(e,n,r)=>"0"==e&&t.letter(n,"x")&&t.hexNum(r),expWithSign:(e,n,r)=>t.letter(e,"e")&&t.sign(n)&&t.digit(r),exp:(e,n)=>t.letter(e,"e")&&t.digit(n),dots:(e,n)=>t.dot(e)&&t.dot(n),letter:(e,t)=>String(e).toLowerCase()==String(t).toLowerCase(),comment:(e,t)=>"/"==e&&"*"==t,inlineComment:(e,t)=>"/"==e&&"/"===t,selfClosedTag:(e,t)=>"/"==e&&">"==t,closedTag:(e,t)=>"<"==e&&"/"==t},n=class{constructor({type:e,value:t,pos:n,status:r}){this.type=e,this.value=t,this.pos=n,r&&(this.status=r)}isSymbol(e){return 0==arguments.length?"Symbol"==this.type:(arguments.length>1&&(e=Array.from(arguments)),Array.isArray(e)?e.some((e=>e===this.value)):e===this.value)}isSpace(){return"Space"==this.type}isNumber(){return"Number"==this.type}isWord(){return"Word"==this.type}};function r(e){let t=-1,n=e.length,r=-1,s=0;return{curr:(n=0)=>e[t+n],next(n=1){let i=e[t+=n];return"\n"===i?(s++,r=0):r+=n,i},end:()=>t>=n,get:()=>({prev:e[t-1],curr:e[t+0],next:e[t+1],next2:e[t+2],next3:e[t+3],pos:[r,s]})}}function s(e){for(;e.next();){let{curr:n,prev:r}=e.get();if(t.comment(n,r))break}}function i(e){for(;e.next()&&"\n"!==e.curr(););}function l(e){return[":",";",",","{","}","(",")","[","]"].includes(e)}function a(e){let n="";for(;!e.end();){let{curr:r,next:s}=e.get();n+=r;let i=t.symbol(s)||t.space(s)||t.digit(s);if(n.length&&i&&!t.closedTag(r,s))break;e.next()}return n.trim()}function o(e){let n="";for(;!e.end();){let{curr:r,next:s}=e.get();if(n+=r,!t.space(s))break;e.next()}return n}function u(e){let n="",r=!1;for(;!e.end();){let{curr:s,next:i,next2:l,next3:a}=e.get();if(n+=s,r&&t.dot(i))break;if(t.dot(s)&&(r=!0),t.dots(i,l))break;if(t.expWithSign(i,l,a))n+=e.next()+e.next();else if(t.exp(i,l))n+=e.next();else if(!t.digit(i)&&!t.dot(i))break;e.next()}return n}function c(e){let n="0x";for(e.next(2);!e.end();){let{curr:r,next:s}=e.get();if(n+=r,!t.hexNum(s))break;e.next()}return n}function h(e){return e[e.length-1]}function p(e,p={}){let f=r(String(e).trim()),d=[],m=[];for(;f.next();){let{prev:e,curr:r,next:g,next2:v,pos:y}=f.get();if(t.comment(r,g))s(f);else if(p.ignoreInlineComment&&t.inlineComment(r,g))i(f);else if(t.hex(r,g,v)){let e=c(f);d.push(new n({type:"Number",value:e,pos:y}))}else if(t.digit(r)||t.digit(g)&&t.dot(r)&&!t.dots(e,r)){let e=u(f);d.push(new n({type:"Number",value:e,pos:y}))}else if(t.symbol(r)){let e=h(d),s=t.digit(g)||t.dot(g)&&t.digit(v),i=e&&(e.isNumber()||e.isWord()||e.isSymbol(")"));if("-"===r&&s&&!i){let e=u(f);d.push(new n({type:"Number",value:e,pos:y}));continue}let l={type:"Symbol",value:r,pos:y};if(m.length&&t.escape(e.value)){d.pop();let e=a(f);e.length&&d.push(new n({type:"Word",value:e,pos:y}))}else{if(t.quote(r)){h(m)==r?(m.pop(),l.status="close"):(m.push(r),l.status="open")}d.push(new n(l))}}else if(t.space(r)){let e=o(f),t=h(d),{next:s}=f.get();if(!m.length&&t){let n=t.value,i=l(n)&&")"!==n,a=l(s)&&"("!==s;if(i||a)continue;e=p.preserveLineBreak?r:" "}d.length&&s&&s.trim()&&d.push(new n({type:"Space",value:e,pos:y}))}else{let e=a(f);e.length&&d.push(new n({type:"Word",value:e,pos:y}))}}let g=h(d);return g&&g.isSpace()&&(d.length=d.length-1),d}function f(e){let t=[];for(;e.next();){let{curr:n,next:r}=e.get();if("var"===n.value){if(r&&r.isSymbol("(")){e.next();let n=d(e);g(n.name)&&t.push(n)}}else if(t.length&&!n.isSymbol(","))break}return t}function d(e){let t={},n=[];for(;e.next();){let{curr:r,next:s}=e.get();if(r.isSymbol(")",";")&&!t.name){t.name=m(n);break}r.isSymbol(",")?(void 0===t.name&&(t.name=m(n),n=[]),t.name&&(t.fallback=f(e))):n.push(r)}return t}function m(e){return e.map((e=>e.value)).join("")}function g(e){return void 0!==e&&(!(e.length<=2)&&(!e.substr(2).startsWith("-")&&!!e.startsWith("--")))}var v=function(e){return f(r(p(e)))};function y(e,t,n){return e=Number(e)||0,Math.max(t,Math.min(n,e))}function b(e,t){for(let[n,r]of Object.entries(t))e[n]=e[r];return e}function x(e){return/^[a-zA-Z]$/.test(e)}function _(e){return null==e}function $(e){return _(e)||Number.isNaN(e)}function k(e){return _(e)||""===e}function w(e){let t=t=>(...n)=>e(t,...n);return t.lazy=!0,t}function S(e,t,n){return"c-"+e+"-"+t+"-"+n}function j(e){let t=e;for(;t&&!_(t.value);)t=t.value;return"object"==typeof t&&"value"in t?t.value??"":t??""}function A(e,t,n=0){let r=new Image;r.crossOrigin="anonymous",r.src=e,r.onload=function(){setTimeout(t,n)}}function N(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function E(e){let t=document.createElement("textarea");return t.innerHTML=e,t.value}function T(e,t=0){e=String(e);let n=3735928559^t,r=1103547991^t;for(let t,s=0;s<e.length;s++)t=e.charCodeAt(s),n=Math.imul(n^t,2654435761),r=Math.imul(r^t,1597334677);return n=Math.imul(n^n>>>16,2246822507)^Math.imul(r^r>>>13,3266489909),r=Math.imul(r^r>>>16,2246822507)^Math.imul(n^n>>>13,3266489909),4294967296*(2097151&r)+(n>>>0)}function C(e,t,n){return t+e*(n-t)}function R(e=""){return e+Math.random().toString(32).slice(2)}function M(e){return _(e)?[]:Array.isArray(e)?e:[e]}function P(e,t="\n"){return(e||[]).join(t)}function z(e,t=1){return _(e)?"":e[e.length-t]}function O(e){return e[0]}var I=function(e,t={symbol:",",noSpace:!1,verbose:!1}){let n=[],s=[],i=[],l=[],a="",o=t.symbol||",",u={},c={},h=[];if(k(e))return n;Array.isArray(o)||(o=[o]),o.forEach((e=>{let[t,n=1/0]=String(e).split(/\s+/);u[t]=0,c[t]=n}));const f=Object.keys(c),d=r(p(e));function m(){h=f.filter((e=>u[e]<c[e]))}function g(e){return t.noSpace?e.isSymbol(h):e.isSymbol(h)||e.isSpace()}function v(e){let r=function(e){return e.map((e=>e.value)).join("")}(e);t.verbose?(a.length||r.length)&&n.push({group:a,value:r}):n.push(r)}for(m();d.next();){let{prev:e,curr:n,next:r}=d.get();n.isSymbol("(")&&i.push(n.value),n.isSymbol(")")&&i.pop(),"open"===n.status&&l.push(n.value),"close"===n.status&&l.pop();let o=!i.length&&!l.length;if(o){let i=t.noSpace&&n.isSpace()&&g(r),l=t.noSpace&&n.isSpace()&&g(e);if(n.isSpace()&&!s.length)continue;if(i||l)continue}if(o&&g(n)){u[n.value]+=1;v(s),a=n.value,s=[],m()}else s.push(n)}return s.length&&v(s),n},W=["xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"];function L(e,t){let n,r=[],s=[],i=[],l=!1;for(;e.next();){let{curr:t,next:a}=e.get();t.isSymbol("(")&&!s.length?i.push(t):t.isSymbol(")")&&!s.length&&i.pop(),t.isSymbol("'",'"')&&("open"===t.status?s.push(t):s.pop());let o=!s.length&&!i.length&&(!a||t.isSymbol(";")||a.isSymbol("}"));if(t.isSymbol("'",'"')&&a&&a.isSymbol("}")&&!s.length&&(o=!0),!i.length&&!s.length&&t.isSymbol("{")){let t=Y(r);if(!t.length)continue;let s=t.pop(),i=G(...t,s);for(n=X(D(e,V(s,{type:"block",name:s,value:[]})),i);s=t.pop();)n=X(V(s,{type:"block",name:s,value:[n]}),i);l=!0;break}if(r.push(t),o)break}return r.length&&!n?(t._valueTokens=r,t.value=B(r)):n&&(t.value=n),l&&(t.value.inline=!0),t.origin&&(t.origin.value=t.value),t}function U(e){let t=[],n=[];for(;e.next();){let{curr:r}=e.get();if(r.isSymbol("{"))t.push(r.value);else if(r.isSymbol("}")){if(!t.length)break;t.pop()}n.push(r.value)}return n.join("")}function D(e,t){let n=[],r=[],s=t&&t.type||"",i=[];for(;e.next();){let{prev:l,curr:a,next:o}=e.get();a.isSymbol("(")&&i.push(a.value),a.isSymbol(")")&&i.length&&i.pop();let u=!o||a.isSymbol("}");if(Z(s)&&u){if(!o&&n.length&&!a.isSymbol("}")){"string"==typeof n[n.length-1].value&&(n[n.length-1].value+=";"+a.value)}t.value=n;break}if(a.isSymbol("{")){let s=Y(r);if(!s.length)continue;G(t.name)&&(s=[B(r)]);let i=s.pop(),l=G(...s,t.name,i);const a=[...s,i],o=a.indexOf("style");if(o>=0){let t="";const r=a.slice(o+1);r.length>0&&(t=r.join(" ")+"{"),t+=U(e),r.length>0&&(t+="}"),n.push({type:"block",name:"style",value:t})}else{let t=X(D(e,V(i,{type:"block",name:i,value:[]})),l);for(;i=s.pop();)t=X(V(i,{type:"block",name:i,value:[t]}),l);n.push(t)}r=[]}else if(a.isSymbol(":")&&!i.length&&!F(l,o)&&r.length){let i=q(r,(e=>e.isSymbol(","))),l={type:"statement",name:"unknown",value:""};i.length>1&&(l.origin={name:i});let a=L(e,l),o=I(a.value),u=i.length>1&&o.length===i.length;i.forEach(((e,t)=>{let r=Object.assign({},a,{name:e});/^\-\-/.test(e)&&(r.variable=!0),u&&(r.value=o[t]),/viewBox/i.test(e)&&(r.detail=H(r.value,r._valueTokens)),delete r._valueTokens,n.push(r)})),Z(s)&&(t.value=n),r=[]}else a.isSymbol(";")?n.length&&r.length&&(n[n.length-1].value+=";"+B(r),r=[]):r.push(a)}return n.length&&Z(s)&&(t.value=n),s?t:n}function F(e,t){let n=e&&e.value,r=t&&t.value;return W.includes(n+":"+r)}function B(e){return e.filter(((t,n)=>!t.isSymbol(";","}")||n!==e.length-1)).map((e=>e.value)).join("")}function X(e,t){let n=e.name||"";if(t)return e;let r=n.split(/[#.]/)[0];if(!r)return e;let s=n.match(/#([^.#]+)/);s&&e.value.push({type:"statement",name:"id",value:s[1]});let i=n.match(/\.([^.#]+)/g);if(i){let t=i.map((e=>e.slice(1))).join(" ");e.value.push({type:"statement",name:"class",value:t})}return e.name=r,e}function q(e,t){let n=[],r=[];return e.forEach((e=>{t(e)?(n.push(B(r)),r=[]):r.push(e)})),r.length&&n.push(B(r)),n}function Y(e){let t,n=[],s=r(e);for(;s.next();){let{prev:e,curr:r,next:i}=s.get(),l=e&&i&&"x"===r.value&&e.isNumber()&&i.isNumber();(!r.isWord()||t||l)&&n.length?n[n.length-1]=(n[n.length-1]+r.value).trim():n.push(r.value.trim()),r.isSymbol()?t=!0:r.isSpace()||(t=!1)}return n}function H(e,t){const n={value:[]};let r;if(!Array.isArray(t))return n;for(let e of t)e.isSpace()||e.isSymbol(",",";")||(n.value.length<4&&e.isNumber()?n.value.push(Number(e.value)):e.isNumber()&&r?(n[r]=Number(e.value),r=null):e.isWord()&&(r=e.value));return n}function V(e,t){let n=Object.assign({},t);if(/\*\s*[0-9]/.test(e)){let[t,r]=e.split("*");r&&(n.times=r.trim(),n.pureName=t.trim())}return n}function G(...e){return e.includes("style")}function Z(e){return"block"===e}var K=function(e,t){return function(e){let t,n=[];for(let r of e.value)"svg"===r.name&&(t=r),r.variable&&n.push(r);if(t&&Array.isArray(t.value)){for(let e of n)t.value.find((t=>t.name==e.name))||t.value.unshift(e);return t}return e}(D(r(p(e)),t||{type:"block",name:"svg",value:[]}))};function J(e,t){let n="";if("block"===e.type){let t=Array.isArray(e.value)&&e.value[0]&&e.value[0].inline;if(e.times?n+="@M"+e.times+"("+e.pureName+"{":n+=e.name+"{","style"===e.name)n+=e.value;else if(Array.isArray(e.value)&&e.value.length){let t="";for(let r of e.value)n+=J(r,t),r.origin&&(t=r.origin.name.join(","))}e.times?n+="})":t||(n+="}")}else if("statement"===e.type){let r=e.origin&&t===e.origin.name.join(","),s=e.origin?e.origin.name.join(","):e.name,i=e.origin?e.origin.value:e.value;r||(n+=i&&i.type?s+":"+J(i):s+":"+i+";")}return n}function Q(e){return J(e).trim()}var ee={func:(e="")=>({type:"func",name:e,arguments:[]}),argument:()=>({type:"argument",value:[]}),text:(e="")=>({type:"text",value:e}),pseudo:(e="")=>({type:"pseudo",selector:e,styles:[]}),cond:(e="")=>({type:"cond",name:e,styles:[],arguments:[]}),rule:(e="")=>({type:"rule",property:e,value:[]}),keyframes:(e="")=>({type:"keyframes",name:e,steps:[]}),step:(e="")=>({type:"step",name:e,styles:[]})},te={white_space:e=>/[\s\n\t]/.test(e),line_break:e=>/\n/.test(e),number:e=>!isNaN(e),pair:e=>['"',"(",")","'"].includes(e),pair_of:(e,t)=>({'"':'"',"'":"'","(":")"}[e]==t),selector(e){let t,n=e.index(),r=[],s=[],i=!1;for(;!e.end();){if(t=e.next(),'"'===t||"'"===t||"`"===t){t===z(s)?s.pop():s.length||s.push(t)}if("("==t&&r.push(t),")"==t&&r.pop(),!r.length&&!s.length){if("{"===t){i=!0;break}if(";"===t||"}"===t){i=!1;break}}}return e.index(n),i}},ne={"\u03c0":Math.PI,"\u220f":Math.PI};function re(e){return/^@(canvas|shaders|doodle)/.test(e)}function se(e=""){let t=0,n=1,r=1;return{curr:(n=0)=>e[t+n],end:()=>e.length<=t,info:()=>({index:t,col:n,line:r}),index:e=>void 0===e?t:t=e,range:(t,n)=>e.substring(t,n),next(){let s=e[t++];return"\n"==s?(r++,n=0):n++,s}}}function ie(e,{col:t,line:n}){console.warn(`(at line ${n}, column ${t}) ${e}`)}function le(e,t){return function(n,r){let s=n.index(),i="";for(;!n.end();){let r=n.next();if(e(r)){t&&(i+=r);break}i+=r}return r&&n.index(s),i}}function ae(e,t){return le((e=>/[^\w@]/.test(e)))(e,t)}function oe(e){return le((e=>/[\s\{]/.test(e)))(e)}function ue(e,t){return le((e=>te.line_break(e)||"{"==e),!0)(e,t)}function ce(e,t){let n,r=ee.step();for(;!e.end()&&"}"!=(n=e.curr());)if(te.white_space(n))e.next();else{if(r.name.length){if(r.styles.push(Se(e,t)),"}"==e.curr())break}else r.name=_e(e,(e=>"{"===e));e.next()}return r}function he(e,t){const n=[];let r;for(;!e.end()&&"}"!=(r=e.curr());)te.white_space(r)||n.push(ce(e,t)),e.next();return n}function pe(e,t){let n,r=ee.keyframes();for(;!e.end()&&"}"!=(n=e.curr());)if(r.name.length){if("{"==n||"{"==e.curr(-1)){e.next(),r.steps=he(e,t);break}e.next()}else if(ae(e),r.name=oe(e),!r.name.length){ie("missing keyframes name",e.info());break}return r}function fe(e,t={}){for(e.next();!e.end();){let n=e.curr();if(t.inline){if("\n"==n)break}else if("*"==(n=e.curr())&&"/"==e.curr(1))break;e.next()}t.inline||(e.next(),e.next())}function de(e){for(e.next();!e.end();){if(">"==e.curr())break;e.next()}}function me(e,t,n,r={}){let s,i=[],l=[],a=[],o="",u="";for(;!e.end();){s=e.curr();let h=e.curr(-1),p=e.index();if(/[\('"`]/.test(s)&&"\\"!==h)a.length&&"("!==s&&s===z(a)?a.pop():a.push(s),o+=s;else if(!n&&("@"==s||"$"===s||"."===h&&t))l.length||(o=o.trimLeft()),o.length&&(l.push(ee.text(o)),o=""),l.push(xe(e,r));else if(n&&/[)]/.test(s)||!n&&/[,)]/.test(s))if(a.length)")"==s&&"("===z(a)&&a.pop(),o+=s;else{if(o.length&&(l.length?/\S/.test(o)&&l.push(ee.text(o)):l.push(ee.text((c=o).trim().length?te.number(+c)?+c:c.trim():c)),o.trim().startsWith("\xb1")&&!n)){let e=o.trim().slice(1),t=structuredClone(l);z(t).value="-"+e,i.push(ve(t)),z(l).value=e}if(i.push(ve(l)),[l,o]=[[],""],")"==s)break}else ne[s]&&!/[0-9]/.test(e.curr(-1))&&(s=ne[s]),o+=s;let f=e.curr(1);if(!(!t||")"!=f&&void 0!==f&&";"!=f&&/[0-9a-zA-Z_\-.]/.test(e.curr())||a.length)){l.length&&i.push(ve(l));break}u+=e.range(p,e.index()+1),e.next()}var c;return[ge(i),u]}function ge(e){let t=z(e[0]);return t&&"text"===t.type&&!String(t.value).trim().length&&(e[0]=e[0].slice(0,-1)),e}function ve(e){let t=e.map((e=>{if("text"==e.type&&"string"==typeof e.value){let t=String(e.value);t.includes("`")&&(e.value=t=t.replace(/`/g,'"')),e.value=t}return e})),n=O(t)||{},r=z(t)||{};if("text"==n.type&&"text"==r.type){let e=O(n.value),s=z(r.value);"string"==typeof n.value&&"string"==typeof r.value&&te.pair_of(e,s)&&(n.value=n.value.slice(1),r.value=r.value.slice(0,r.value.length-1),t.cluster=!0)}return t}function ye(e){let t=JSON.stringify(e);return t.includes("pureName")&&t.includes("times")}function be(e){return/^@svg$/i.test(e)}function xe(e,t={}){let n,r=ee.func(),s=e.curr(),i=!1,l="$"===s;for("@"===s?e.next():s="@";!e.end();){n=e.curr();let l=e.curr(1),a="."==n&&/[a-zA-Z@$]/.test(l);if("("==n||a){i=!0,e.next();let[n,l]=me(e,a,re(s),t);if(be(s)){let e=K(l),r=0;for(let n of e.value)n.variable&&(t[n.name]=Te(`${"\n".repeat(r++)} ${n.name}:${n.value}`)[0].value);if(/\d\s*{/.test(l)&&ye(e)){let r=Q(e);r+=")",n=me(se(r),a,re(s),t)[0]}}r.arguments=n,r.variables=t;break}if(/[0-9a-zA-Z_\-.%]/.test(n)&&(s+=n),!i&&"("!==l&&!/[0-9a-zA-Z_\-.%]/.test(l))break;e.next()}let{fname:a,extra:o}=function(e){let t="",n="";if(/\D$/.test(e)&&!/\d+[x-]\d+/.test(e)||Math[e.slice(1)])return{fname:e,extra:n};for(let r=e.length-1;r>=0;r--){let s=e[r],i=e[r-1],l=e[r+1];if(!(/[\d.]/.test(s)||("x"==s||"-"==s)&&/\d/.test(i)&&/\d/.test(l))){t=e.substring(0,r+1);break}n=s+n}return{fname:t,extra:n}}(s);if(r.name=l?"@$"+s.slice(1):a,o.length&&r.arguments.unshift([{type:"text",value:o}]),l&&r.name.length>2){if(!r.arguments.length){let e=r.name.substring(0,2),t=r.name.substring(2);r.name=e,r.arguments.push([{type:"text",value:t}])}if(/\d$/.test(r.name)){let e=r.name.substring(0,2),t=r.name.substring(2);r.name=e,r.arguments[0][0].value=t}}return r.position=e.info().index,r}function _e(e,t=()=>{}){let n,r=ee.text(),s=0,i=!0;const l=[];l[s]=[];let a=[],o=[];for(;!e.end();){if(n=e.curr(),i&&te.white_space(n)){e.next();continue}if(i=!1,"\n"!=n||te.white_space(e.curr(-1)))if(","!=n||a.length){if((/[;}<]/.test(n)||t(n))&&!o.length){r.value.length&&(l[s].push(r),r=ee.text());break}if("@"!==n&&"$"!==n||!/[\w-\(%]/.test(e.curr(1)))if('"'===n||"'"===n){n===z(o)?o.pop():o.length||o.push(n),r.value+=n}else te.white_space(n)&&te.white_space(e.curr(-1))||("("==n&&a.push(n),")"==n&&a.pop(),ne[n]&&!/[0-9]/.test(e.curr(-1))&&(n=ne[n]),r.value+=n);else r.value.length&&(l[s].push(r),r=ee.text()),l[s].push(xe(e))}else r.value.length&&(l[s].push(r),r=ee.text()),l[++s]=[],i=!0;else r.value+=" ";let u=e.curr();if((";"===u||"}"==u||t(u))&&!o.length)break;e.next()}return r.value.length&&l[s].push(r),l}function $e(e){let t,n="";for(;!e.end()&&"{"!=(t=e.curr());)n+=t,e.next();return n=n.trim(),n}function ke(e){let t,n="",r=[],s={};for(;!e.end();){if("("==(t=e.curr())){n.length&&(s.name?r.push({keyword:n}):s.name=n,n=""),e.next();let t=me(e)[0];r.push({arguments:t})}else if(te.white_space(t))te.white_space(t)&&!s.name?(s.name=n,n=""):te.white_space(t)&&n.length&&(r.push({keyword:n}),n="");else{if("{"==t||")"==t){n.length&&(s.name?r.push({keyword:n}):s.name=n);break}n+=t}e.next()}let[i,...l]=(s.name||"").trim().split(/\s+/);return{name:i,addition:l,segments:r,position:e.info().index}}function we(e,t){let n,r=ee.pseudo();for(;!e.end();){if(n=e.curr(),"/"==n&&"*"==e.curr(1))fe(e);else{if("}"==n)break;if(te.white_space(n)){e.next();continue}if(r.selector)if(":"==n){let n=we(e,t);n.selector&&r.styles.push(n)}else if("&"==n)r.styles.push(je(e,t));else{let n=Se(e,t);if("@use"==n.property?r.styles=r.styles.concat(n.value):n.property&&r.styles.push(n),"}"==e.curr())break}else r.selector=$e(e)}e.next()}return r}function Se(e,t){let n,r=ee.rule(),s=e.index(),i=[],l=[],a="";for(;!e.end();){if(n=e.curr(),"/"==n&&"*"==e.curr(1)&&fe(e),'"'===n||"'"===n||"`"===n){n===z(l)?l.pop():l.length||l.push(n)}if("("==n&&i.push(n),")"==n&&i.pop(),i.length||l.length)a+=n;else{if("}"==n)break;if(";"===n&&a.trim().length){r.property.length||(r.type="at-rule",r.value=a+n),e.next();break}if(":"===n){r.property=a.trim(),"@use"==r.property?r.value=Ee(e,t):(e.next(),r.value=_e(e));break}a+=n}e.next()}let o=e.index();return r.raw=()=>e.range(s,o).trim(),r}function je(e,t){let n,r=ee.cond();for(;!e.end();){if(n=e.curr(),"/"==n&&"*"==e.curr(1))fe(e);else{if("}"==n)break;if(r.name.length)if(":"==n){let t=we(e);t.selector&&r.styles.push(t)}else if("&"==n)r.styles.push(je(e));else if("@"==n&&"@keyframes"===ae(e,!0)){let n=pe(e,t);r.styles.push(n)}else if("@"!=n||ue(e,!0).includes(":")){if(te.white_space(n)){e.next();continue}if(te.selector(e)){let n=je(e,t);n.name.length&&r.styles.push(n)}else{let n=Se(e,t);if(n.property&&r.styles.push(n),"}"==e.curr())break}}else r.styles.push(je(e));else Object.assign(r,ke(e))}e.next()}return r}function Ae(e,t){let n="";return e&&e.get_variable&&(n=e.get_variable(t)),n}function Ne(e,t){e.forEach&&e.forEach((e=>{if("text"==e.type&&e.value){let n=v(e.value);e.value=n.reduce(((e,n)=>{let r,s="",i="";s=Ae(t,n.name),!s&&n.fallback&&n.fallback.every((e=>{if(i=Ae(t,e.name),i)return s=i,!1}));try{r=Te(s,t)}catch(e){}return r&&e.push.apply(e,r),e}),[])}"func"==e.type&&e.arguments&&e.arguments.forEach((e=>{Ne(e,t)}))}))}function Ee(e,t){return e.next(),(_e(e)||[]).reduce(((e,n)=>{Ne(n,t);let[r]=n;return r.value&&r.value.length&&e.push(...r.value),e}),[])}function Te(e,t){const n=se(e),r=[];for(;!n.end();){let e=n.curr();if(te.white_space(e))n.next();else{if("/"==e&&"*"==n.curr(1))fe(n);else if(":"==e){let e=we(n,t);e.selector&&r.push(e)}else if("@"==e&&"@keyframes"===ae(n,!0)){let e=pe(n,t);r.push(e)}else if("<"==e)de(n);else if(te.selector(n)){let e=je(n,t);e.name.length&&r.push(e)}else if(!te.white_space(e)){let e=Se(n,t);(e.property||"at-rule"===e.type)&&r.push(e)}n.next()}}return r}function Ce(e,t=64){const[n,r,s]=[1,t,t*t];let[i,l,a]=(e+"").replace(/\s+/g,"").replace(/[,\uff0cxX]+/g,"x").split("x").map((e=>parseInt(e)));const o=1==i||1==l?s:r,u=1==i&&1==l?s:n,c={x:y(i||n,1,o),y:y(l||i||n,1,o),z:y(a||n,1,u)};return Object.assign({},c,{count:c.x*c.y*c.z,ratio:c.x/c.y})}function Re(e){return/^texture\w*$|^(fragment|vertex)$/.test(e)}function Me(){return new n({type:"LineBreak",value:"\n"})}function Pe(e){let t=e[0],n=e[e.length-1];for(;t&&t.isSymbol("(")&&n&&n.isSymbol(")");)t=(e=e.slice(1,e.length-1))[0],n=e[e.length-1];return e}function ze(e){return Pe(e).map((e=>e.value)).join("")}var Oe=function(e){let t,n,s=r(Pe(p(e,{preserveLineBreak:!0,ignoreInlineComment:!0}))),i=[],l=[],a={textures:[]};for(;s.next();){let{curr:e,next:r}=s.get();if(e.isSymbol("{")){if(i.length)l.push(e);else{let n=ze(l);Re(n)?(t=n,l=[]):l.push(e)}i.push("{")}else if(e.isSymbol("}"))if(i.pop(),!i.length&&t){let e=ze(l);t&&e.length&&(t.startsWith("texture")?a.textures.push({name:t,value:e}):a[t]=e,l=[]),t=null}else l.push(e);else k(n)||n==e.pos[1]||(l.push(Me()),n=null),t&&t.startsWith("texture")||e.isWord()&&e.value.startsWith("#")&&(l.push(Me()),n=r.pos[1]),l.push(e)}return k(a.fragment)&&(a.fragment=ze(l),a.textures=a.textures||[]),a},Ie=new Map;var We=function(e){if(Ie.has(e))return Ie.get(e);let t=r(p(e)),n={},s={commands:[],valid:!0};for(;t.next();){let{curr:e}=t.get();if(!e.isSpace()&&!e.isSymbol(","))if(e.isWord())n.name&&(s.commands.push(n),n={}),n.name=e.value,n.value=[],"MmLlHhVvCcSsQqTtAaZz".includes(e.value)?"mlhvcsqtaz".includes(e.value)?n.type="relative":n.type="absolute":(n.type="unknown",s.valid=!1);else if(n.value){let r=e.value;if(e.isNumber())r=Number(e.value);else if(e.isSymbol("-")||e.isSymbol("+")){let{next:n}=t.get();n&&n.isNumber()&&(t.next(),r=Number(e.value+n.value))}n.value.push(r)}else n.name||(s.valid=!1)}return n.name&&s.commands.push(n),Ie.set(e,s),s};var Le=function(e){let t=r(p(e)),n={},s=!1;for(;t.next();){let{prev:e,curr:r,next:i}=t.get(),l=s&&(r.isWord()||r.isSymbol())&&e&&e.isNumber()&&!i;if(r.isNumber())n.value=Number(r.value),s=!0;else{if(!l)break;n.unit=r.value}}return n},Ue='xmlns="http://www.w3.org/2000/svg"',De='xmlns="http://www.w3.org/1999/xhtml"',Fe='xmlns:xlink="http://www.w3.org/1999/xlink"';function Be(e,t){return`url("data:image/svg+xml;utf8,${encodeURIComponent(e)+(t?`#${t}`:"")}")`}function Xe(e){return e.includes("<svg")||(e=`<svg ${Ue} ${Fe}>${e}</svg>`),e.includes("xmlns")||(e=e.replace(/<svg([\s>])/,`<svg ${Ue} ${Fe}$1`)),e}var qe=function(){let e=0;return(t="")=>`${t}-${++e}`}(),Ye=class{constructor(e,t=""){if(!e)throw new Error("Tag name is required");this.id=Symbol(),this.name=e,this.body=[],this.attrs={},this.isTextNode()&&(this.body=t)}isTextNode(){return"text-node"===this.name}find(e){let t=e.attrs.id,n=e.name;if(Array.isArray(this.body)&&void 0!==t)return this.body.find((e=>e.attrs.id===t&&e.name===n))}findSpareDefs(){return this.body.find((e=>"defs"===e.name&&!e.attrs.id))}append(e){Array.isArray(e)||(e=[e]);for(let t of e)this.isTextNode()||this.body.push(t)}merge(e){for(let[t,n]of Object.entries(e.attrs))this.attrs[t]=n;Array.isArray(e.body)&&this.body.push(...e.body)}attr(e,t){if(!this.isTextNode())return void 0===t?this.attrs[e]:this.attrs[e]=t}toString(){if(this.isTextNode())return He(this.body);let e=[""],t=[];for(let[t,n]of Object.entries(this.attrs))n=He(n),e.push(`${t}="${n}"`);for(let e of this.body)t.push(e.toString());return t.join("").length||/svg/i.test(this.name)?`<${this.name}${e.join(" ")}>${t.join("")}</${this.name}>`:`<${this.name}${e.join(" ")}/>`}};function He(e){let t=(e=String(e)).startsWith('"')&&e.endsWith('"'),n=e.startsWith("'")&&e.endsWith("'");return t||n?e.substring(1,e.length-1):e}function Ve(e,t,n,r){let s;if(t||(t=new Ye("root")),"block"===e.type)if("style"===e.name){let n=new Ye("style");n.append(e.value),t.append(n)}else{let i=new Ye(e.name);if(r||(r=i).attr("xmlns",Ue.split("=")[1]),"defs"===e.name){let e=r.findSpareDefs();e&&(i=e)}for(let t of e.value){e.parent=n;let l=Ve(t,i,e,r);l&&(s=l)}let l=e&&e.inline&&"defs"!==e.name,a=n&&n.inline&&"defs"===n.name,o=a&&1==n.value.length;if(l||a){let t=e.value.find((e=>"statement"===e.type&&"id"===e.name));t?s=t.value:(o||l)&&(s=qe(e.name),i.attr("id",s))}let u=t.find(i);if(u)u.merge(i);else if("defs"===e.name){let e=r.findSpareDefs();e&&!i.attrs.id?i.id!==e.id&&e.append(i.body):r.append(i)}else t.append(i)}if("statement"===e.type&&!e.variable)if("content"===e.name){let n=new Ye("text-node",e.value);t.append(n)}else if(e.name.startsWith("style ")){let n=(e.name.split("style ")[1]||"").trim();if(n.length){let r=t.attr("style")||"";t.attr("style",r+function(e,t){return`${e}:${t};`}(n,e.value))}}else{let s=e.value;if(s&&"block"===s.type){let t=Ve(e.value,r,e,r);_(t)?s="":(s=`url(#${t})`,"xlink:href"!==e.name&&"href"!==e.name||(s=`#${t}`))}if(/viewBox/i.test(e.name))s=function(e){let t=e.detail.value,n=e.detail.padding||e.detail.p||e.detail.expand;if(!t.length)return"";let[r,s,i,l]=t;return n&&([r,s,i,l]=[r-n,s-n,i+2*n,l+2*n]),`${r} ${s} ${i} ${l}`}(e),s&&t.attr(e.name,s);else if("draw"!==e.name&&"animate"!==e.name||"path"!==(i=n&&n.name)&&"line"!==i&&"circle"!==i&&"ellipse"!==i&&"rect"!==i&&"polygon"!==i&&"polyline"!==i)t.attr(e.name,s);else{let[e,n]=String(s).split(/\s+/);("indefinite"===e||"infinite"===e||/\d$/.test(e))&&([e,n]=[n,e]),"infinite"===n&&(n="indefinite"),t.attr("stroke-dasharray",10),t.attr("pathLength",10);let r=new Ye("animate");r.attr("attributeName","stroke-dashoffset"),r.attr("from",10),r.attr("to",0),r.attr("dur",e),n&&r.attr("repeatCount",n),t.append(r)}e.name.includes("xlink:")&&r.attr("xmlns:xlink",Fe.split("=")[1])}var i;return n?s:r.toString()}function Ge(e){return Ve(e)}var Ze=["auto","reverse"],Ke=["deg","rad","grad","turn"];var Je=function(e){let t=r(p(e)),n=!1,s="",i={direction:"",angle:""};for(;t.next();){let{prev:e,curr:r,next:l}=t.get();if(r.isWord()&&Ze.includes(r.value))i.direction=r.value,n=!0;else if(r.isNumber())i.angle=Number(r.value),n=!0;else if(r.isWord()&&e&&e.isNumber()&&Ke.includes(r.value))s=r.value;else if(r.isSpace()&&""!==i.direction&&""!==i.angle)break}return n||(i.direction="auto"),function(e,t){let{angle:n}=e;""===n&&(n=0);"rad"===t&&(n/=Math.PI/180);"grad"===t&&(n*=.9);"turn"===t&&(n*=360);return Object.assign({},e,{angle:n})}(i,s)};function Qe(e,t,n){return["fill-rule","fill"].includes(e)?t:n?`-1 * (${t})`:t}function et(e){return e.map((e=>e.value)).join("")}var tt=function(e){let t,n=r(p(e)),s={},i=[],l=!1;for(;n.next();){let{prev:e,curr:r,next:a}=n.get();if(r.isSymbol(":")&&!t)t=et(i),i=[];else if(r.isSymbol(";")&&t)s[t]=Qe(t,et(i),l),i=[],t=null,l=!1;else if(!r.isSymbol(";")){let n=e&&e.isSymbol("-"),s=a&&a.isSymbol("-"),o=r.isSymbol("-");t||i.length||!o||n||s||a&&a.isSymbol(":")?i.push(r):l=!0}}return i.length&&t&&(s[t]=Qe(t,et(i),l)),s},nt=new class{constructor(){this.cache=new Map}clear(){this.cache.clear()}set(e,t){if(_(e))return"";let n=this.getKey(e);return this.cache.set(n,t),t}has(e){let t=this.getKey(e);return this.cache.has(t)}get(e){let t=this.getKey(e);return this.cache.get(t)}getKey(e){return _(e)?"":T("string"==typeof e?e:JSON.stringify(e))}};function rt(e,t){return(...n)=>{let r=e+n.join("-");return nt.get(r)||nt.set(r,t(...n))}}var st={"\u03c0":Math.PI,gcd(e,t){for(;t;)[e,t]=[t,e%t];return e},match:(e,t,n)=>e?t:n},it={"^":7,"**":7,"*":6,"/":6,"\xf7":6,"%":6,"&":5,"|":5,"+":4,"-":4,"<":3,"<<":3,">":3,">>":3,"=":3,"==":3,"\u2264":3,"<=":3,"\u2265":3,">=":3,"\u2260":3,"!=":3,"\u2227":2,"&&":2,"\u2228":2,"||":2,"(":1,")":1},lt=new Set(["**","==","!=","<=",">=","&&","||","<<",">>"]),at=/^-?(\d+\.?\d*|\d*\.?\d+)(e[+-]?\d+)?$/i,ot=/^-/,ut=/\d/,ct=/^[<>&|]+$/,ht=/[()]/,pt=/^-\D/;function ft(e){return Object.prototype.hasOwnProperty.call(it,e)}function dt(e){if(nt.has(e))return nt.get(e);const t=function(e){const t=[];let n=0;for(;n<e.length;){const r=e[n],{type:s,value:i}=r;if("Space"!==s)if("Number"!==s)if("Word"!==s)if("Symbol"!==s)n++;else{if(","===i){t.push({type:"comma",value:i}),n++;continue}if("!"===i){const r=e[n+1];if(r&&"="===r.value){t.push({type:"operator",value:"!="}),n+=2;continue}t.push({type:"operator",value:i}),n++;continue}if(")"===i){t.push({type:"operator",value:i});const r=e[n+1],s=r&&(ft(r.value)||ct.test(r.value)||"!"===r.value);r&&("Number"===r.type||"Word"===r.type||"Symbol"===r.type&&"("===r.value||"Symbol"===r.type&&!s&&","!==r.value&&")"!==r.value)&&t.push({type:"operator",value:"*"}),n++;continue}const r=e[n+1];if(r&&"Symbol"===r.type){const e=i+r.value;if(lt.has(e)){t.push({type:"operator",value:e}),n+=2;continue}}if("+"===i||"-"===i){const r=z(t);if(!t.length||r&&"operator"===r.type&&!ht.test(r.value)){let r="-"===i?-1:1,s=n+1;for(;s<e.length;){for(;s<e.length&&"Space"===e[s].type;)s++;const t=e[s];if(!t||"+"!==t.value&&"-"!==t.value)break;"-"===t.value&&(r*=-1),s++}for(;s<e.length&&"Space"===e[s].type;)s++;const l=e[s];if(l&&("Number"===l.type||"Word"===l.type)){const e=(-1===r?"-":"")+l.value;t.push({type:"number",value:e}),n=s+1;continue}if(!t.length){t.push({type:"number",value:-1===r?"-1":"1"}),t.push({type:"operator",value:"*"}),n=s;continue}}}if(ft(i)){t.push({type:"operator",value:i}),n++;continue}const s=r&&"Symbol"===r.type&&/[(),]/.test(r.value),l=r&&(ft(r.value)||ct.test(r.value)||"!"===r.value);if(r&&("Number"===r.type||"Word"===r.type||"Symbol"===r.type)&&!s&&!l){t.push({type:"number",value:i}),t.push({type:"operator",value:"*"}),n++;continue}t.push({type:"number",value:i}),n++}else{if(ft(i)||"!"===i||ct.test(i)){const r=e[n+1];if(r&&("Word"===r.type||"Symbol"===r.type)){const e=i+r.value;if(lt.has(e)){t.push({type:"operator",value:e}),n+=2;continue}}t.push({type:"operator",value:i}),n++;continue}const r=e[n+1];if(r&&"Number"===r.type&&ot.test(r.value)){t.push({type:"number",value:i}),t.push({type:"operator",value:"-"}),t.push({type:"number",value:r.value.slice(1)}),n+=2;continue}if(r&&"Number"===r.type&&!ot.test(r.value)){t.push({type:"number",value:i+r.value}),n+=2;continue}if(r&&"("===r.value){t.push({type:"number",value:i}),n++;continue}const s=r&&"Symbol"===r.type&&/[(),]/.test(r.value),l=r&&(ft(r.value)||ct.test(r.value)||"!"===r.value);if(r&&"Symbol"===r.type&&!s&&!l){t.push({type:"number",value:i}),t.push({type:"operator",value:"*"}),n++;continue}t.push({type:"number",value:i}),n++}else{const r=e[n+1],s=r&&(ft(r.value)||ct.test(r.value)||"!"===r.value),l=r&&"Symbol"===r.type&&/[,]/.test(r.value),a=/e[+-]?\d+$/i.test(i);if(r&&"("===r.value){t.push({type:"number",value:i}),t.push({type:"operator",value:"*"}),n++;continue}if(a&&r&&"Word"===r.type){t.push({type:"number",value:i}),t.push({type:"operator",value:"*"}),n++;continue}if(r&&("Word"===r.type||"Symbol"===r.type)&&!s&&!l){t.push({type:"number",value:i+r.value}),n+=2;continue}t.push({type:"number",value:i}),n++}else n++}return t}(p(String(e)));return nt.set(e,t)}function mt(e){const t=dt(e),n=[],r=[];for(let e=0;e<t.length;e++){const{type:s,value:i}=t[e],l=t[e+1]||{};if("number"===s){const n=at.test(i)||"-"===i||"+"===i;if("("!==l.value||n)n?r.push({type:"number",value:i}):r.push({type:"variable",value:i});else{const{args:n,endIndex:s}=gt(t,e+1);r.push({type:"function",name:i,value:n}),e=s}}else if("operator"===s)if("("===i)n.push(i);else if(")"===i){for(;n.length&&"("!==z(n);)r.push({type:"operator",value:n.pop()});n.pop()}else{const e="^"===i||"**"===i;for(;n.length;){const t=z(n),s=it[t],l=it[i];if(!(e?s>l:s>=l))break;{const e=n.pop();ht.test(e)||r.push({type:"operator",value:e})}}n.push(i)}}for(;n.length;)r.push({type:"operator",value:n.pop()});return r}function gt(e,t){const n=[];let r=0;const s=[];let i=t;for(e[i]&&"("===e[i].value&&(r=1,i++);i<e.length;){const t=e[i],{value:l}=t;if("("===l)r++,s.push(l);else if(")"===l){if(r--,0===r){s.length&&n.push(mt(s.join("")));break}s.push(l)}else","===l&&1===r?(s.length&&n.push(mt(s.join(""))),s.length=0):s.push(l);i++}return{args:n,endIndex:i}}function vt(e,t={},n=[]){const r=[];let s=0;for(;s<e.length;){let{name:i,value:l,type:a}=e[s++];if("variable"===a){let e=t[l];$(e)&&(e=Math[l]),$(e)&&(e=bt(l,t,n)),$(e)&&pt.test(l)&&(e=bt("-1"+l.slice(1),t,n)),void 0===e&&(e=0),"number"!=typeof e&&(n.push(e),xt(n)?(e=0,n.length=0):e=vt(mt(e),t,n)),r.push(e)}else if("function"===a){let e=!1;ot.test(i)&&(e=!0,i=i.slice(1));let s=l.map((e=>vt(e,t,n)));const a=i.split(".");let o;for(;o=a.pop();){if(!o)continue;const e=t[o]||Math[o];s="function"==typeof e?Array.isArray(s)?e(...s):e(s):0}e&&(s*=-1),r.push(s)}else if(ut.test(l))r.push(l);else{const t=r.pop(),n=r.pop();s>=e.length&&void 0===n?r.push(t):r.push(yt(l,Number(n),Number(t)))}}return Number(r[0])||0}function yt(e,t,n){switch(e){case"+":return t+n;case"-":return t-n;case"*":return t*n;case"%":return t%n;case"|":return t|n;case"&":return t&n;case"<":return t<n;case">":return t>n;case"^":case"**":return t**n;case"\xf7":case"/":return t/n;case"=":case"==":return t===n?1:0;case"\u2264":case"<=":return t<=n;case"\u2265":case">=":return t>=n;case"\u2260":case"!=":return t!==n?1:0;case"\u2227":case"&&":return t&&n;case"\u2228":case"||":return t||n;case"<<":return t<<n;case">>":return t>>n;default:return 0}}function bt(e,t,n){const r=e.match(/([\d.\-]+)(.*)/);if(!r)return;const[,s,i]=r,l=t[i];return void 0===l?l:"number"==typeof l?Number(s)*l:(n.push(l),xt(n)?(n.length=0,0):s*vt(mt(l),t,n))}function xt(e){if(e.length>50)return!0;if(e.length<4)return!1;const t=e[e.length-1];for(let n=2;n<=4;n++)if(e[e.length-n]!==t)return!1;return!0}function _t(e,t){return vt(mt(e),t?Object.assign({},st,t):st)}var{cos:$t,sin:kt,abs:wt,atan2:St,PI:jt}=Math,At={circle:"\n split:180;scale:.99\n ",triangle:"\n rotate:30;scale:1.1;move:0 .2\n ",pentagon:"\n split:5;rotate:54\n ",hexagon:"\n split:6;rotate:30;scale:.98\n ",octagon:"\n split:8;rotate:22.5;scale:.99\n ",star:"\n split:10;r:cos(5t);rotate:-18;scale:.99\n ",infinity:"\n split:180;scale:.99;x:cos(t)*.99 / (sin(t)^2 + 1);y:x * sin(t)\n ",heart:"\n split:180;rotate:180;a:cos(t)*13/18 - cos(2t)*5/18;b:cos(3t)/18 + cos(4t)/18;x:(.75 * sin(t)^3) * 1.2;y:(a - b + .2) * -1.1\n ",bean:"\n split:180;r:sin(t)^3 + cos(t)^3;move:-.35 .35;",bicorn:"\n split:180;x:cos(t);y:sin(t)^2 / (2 + sin(t)) - .5\n ",drop:"\n split:180;rotate:90;scale:.95;x:sin(t);y:(1 + sin(t)) * cos(t) / 1.6\n ",fish:"\n split:240;x:cos(t) - sin(t)^2 / sqrt(2) - .04;y:sin(2t)/2\n ",whale:"\n split:240;rotate:180;R:3.4 * (sin(t)^2 - .5) * cos(t);x:cos(t) * R + .75;y:sin(t) * R * 1.2\n ",windmill:"\n split:18;R:seq(.618, 1, 0);T:seq(t-.55, t, t);x:R * cos(T);y:R * sin(T)\n ",vase:"\n split:240;scale:.3;x:sin(4t) + sin(t) * 1.4;y:cos(t) + cos(t) * 4.8 + .3\n ",clover:(e=3)=>(4==(e=y(e,3,5))&&(e=2),`\n split:240;r:cos(${e}t);scale:.98\n`),hypocycloid:(e=3)=>`\n split:240;scale:${[.34,.25,.19][(e=y(e,3,5))-3]};k:${e};x:(k-1)*cos(t) + cos((k-1)*t);y:(k-1)*sin(t) - sin((k-1)*t)\n`,bud:(e=3)=>`\n split:240;scale:.8;r:1 + .2 * cos(${e=y(e,3,10)}t)\n`},Nt=class{constructor(e,t,n){this.x=e,this.y=t,this.extra=n}valueOf(){return this.x+" "+this.y}toString(){return this.valueOf()}};function Et(e,t){t||(t=e=>[$t(e),kt(e)]);let n,r,s=e.split||180,i=e.turn||1,l=e.frame,a=e.fill||e["fill-rule"],o=Je(e.direction||e.dir||""),u=e.unit,c=2*jt*i/s,h=[],p=void 0===e.scale?1:e.scale,f=([e,t,n=0,r=0])=>{if("evenodd"==e||"nonzero"==e)return h.push(new Nt(e,"",""));let[s,i]=Tt(e,-t,p),[l,a]=Tt(n,-r,p),c=function(e,t,n,r,s){let i=180*St(t+r,e-n)/jt;"reverse"===s.direction&&(i-=180);s.direction||(i=90);s.angle&&(i+=s.angle);return i}(s,i,l,a,o);void 0!==u&&"%"!==u?"none"!==u&&(s+=u,i+=u):(s=50*(s+1)+"%",i=50*(i+1)+"%"),h.push(new Nt(s,i,c))};"nonzero"!=a&&"evenodd"!=a||f([a,"",""]);for(let e=0;e<s;++e){let r=t(c*e,e);e||(n=r),f(r)}if(void 0!==l){f(n);let e=l/100;i>1&&(e*=2),0==e&&(e=.002);for(let n=0;n<s;++n){let s=-c*n,[i,l,a=0,o=0]=t(s,n),u=St(l+o,i-a),h=[i-e*$t(u),l-e*kt(u)];n||(r=h),f(h)}f(r),f(n)}return h}function Tt(e,t,n){let r=I(n),s=parseFloat(r[0])||1;return[e*s,t*(void 0!==r[1]?parseFloat(r[1])||1:s)]}function Ct(e,{min:t,max:n}){let r=y(parseInt(e.vertices||e.points||e.split)||0,t,n),s=k(e.x)?"cos(t)":e.x,i=k(e.y)?"sin(t)":e.y,l=k(e.r)?"":e.r,a=k(e.t)?"":e.t,{unit:o,value:u}=Le(l);o&&!e[o]&&"t"!==o&&(k(e.unit)&&(e.unit=o),l=e.r=u),e.degree&&(e.rotate=e.degree),e.origin&&(e.move=e.origin),e.split=r;let c=e.rotate&&Number(e.rotate)||0,h=0,p=Object.assign({},e,{t:0,"\u03b8":0,i:0,seq:(...e)=>e.length?e[h%e.length]:"",range:(e,t=0)=>((e=Number(e)||0)>(t=Number(t)||0)&&([e,t]=[t,e]),e+wt(t-e)/(r-1)*h)});return Et(e,((t,n)=>{h=n,p.t=p["\u03b8"]=a||t,p.i=n+1;let r=_t(s,p),o=_t(i,p),u=0,f=0;if(l){let e=_t(l,p);0==e&&(e=1e-5),a&&(t=_t(a,p)),r=e*$t(t),o=e*kt(t)}return c&&([r,o]=function(e,t,n){let r=-jt/180*n;return[e*$t(r)-t*kt(r),t*$t(r)+e*kt(r)]}(r,o,c)),e.move&&([r,o,u,f]=function(e,t,n){let r=I(n),s=parseFloat(r[0])||0,i=void 0!==r[1]?parseFloat(r[1])||0:s;return[e+s,t-i,s,i]}(r,o,e.move)),[r,o,u,f]}))}function Rt(e,t={},n){let r=t.min||3,s=t.max||3600,i=e+"|"+r+"|"+s+(n?"|m":"");if(nt.has(i))return nt.get(i);let l="",[a,...o]=I(e),u=!1;switch(typeof At[a]){case"function":l=At[a](...o),u=!0;break;case"string":l=At[a],u=!0;break;default:l=e}let c=tt(l);"function"==typeof n&&(c=n(c));let h=Ct(c,{min:r,max:s});return nt.set(i,{rules:c,points:h,preset:u})}function Mt(e,t){let n=t.map((e=>j(e()))),r="",s=[];if(n.length>0){let e=n[0];if(/^-?[\d.]/.test(e)){let{angle:t}=Je(e);r=`gradientTransform:rotate(${t});`}else/^(rotate|translate|scale|skewX|skewY|matrix)\s*\(/.test(e)&&(r=`gradientTransform:${e};`);if(1==n.length&&e.indexOf(",")>-1){let t=I(e,{noSpace:!0});t.length>1&&(n=t)}}r&&(n=n.slice(1));for(let e of n)if("string"==typeof e){let[t,n,r]=I(e);if(!t)continue;s.push({color:t,offset:n,opacity:r})}let i=s.length;return`${e}{${r} ${s.map((({color:e,offset:t,opacity:n},r)=>{!t&&i>=1&&(t=(i>1?r/(i-1)*100:0)+"%");let s=`stop-color:${e}`;return n&&(s+=`;stop-opacity:${n}`),`stop{${t?`offset:${t};`:""} ${s}}`})).join(" ")}}`}var Pt=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180];function zt(e,t,n){return t+e*(n-t)}function Ot(e,t,n,r){let s=15&e,i=s<8?t:n,l=s<4?n:12==s||14==s?t:r;return(1&s?-i:i)+(2&s?-l:l)}var It=class{constructor(e=Math.random){let t=function(e,t){let n=[...e],r=e.length;for(;r;){let e=~~(t()*r--),s=n[r];n[r]=n[e],n[e]=s}return n}(Pt,e);this.p=[].concat(t,t)}noise(e,t,n){let{p:r}=this,[s,i,l]=[e,t,n].map((e=>255&Math.floor(e)));[e,t,n]=[e,t,n].map((e=>e-Math.floor(e)));let[a,o,u]=[e,t,n].map((e=>e*e*e*(e*(6*e-15)+10))),c=r[s]+i,h=r[c]+l,p=r[c+1]+l,f=r[s+1]+i,d=r[f]+l,m=r[f+1]+l;return zt(u,zt(o,zt(a,Ot(r[h],e,t,n),Ot(r[d],e-1,t,n)),zt(a,Ot(r[p],e,t-1,n),Ot(r[m],e-1,t-1,n))),zt(o,zt(a,Ot(r[h+1],e,t,n-1),Ot(r[d+1],e-1,t,n-1)),zt(a,Ot(r[p+1],e,t-1,n-1),Ot(r[m+1],e-1,t-1,n-1))))}};function Wt(e){let t=864e5,n=`${e}-animation`;return{name:e,ticks:t,"animation-name":n,animation:(e="0s")=>`86400000ms steps(10368000) ${e} infinite ${n}`}}var Lt=Wt("cssd-utime"),Ut=Wt("cssd-UTime"),Dt="cssd-umousex",Ft="cssd-umousey",Bt="cssd-uwidth",Xt="cssd-uheight";function qt(e){return(...t)=>{let n=[],r=[];for(let e of t){let{unit:t,value:s}=Le(e);void 0!==t&&n.push(t),void 0!==s&&r.push(s)}let s=e(...r),i=n.find((e=>void 0!==e));return void 0===i?s:Array.isArray(s)?s.map((e=>e+i)):s+i}}function Yt(e){return(...t)=>{let n=t.map((e=>String(e).charCodeAt(0))),r=e(...n);return Array.isArray(r)?r.map((e=>String.fromCharCode(e))):String.fromCharCode(r)}}function*Ht(e,t){let n=e.charCodeAt(0),r=t.charCodeAt(0),s=n<=r?1:-1,i=Math.abs(r-n)+1;for(let e=0;e<i;e++)yield String.fromCharCode(n+e*s)}function Vt(e){let t=String(e);if(91!==t.charCodeAt(0)||93!==t.charCodeAt(t.length-1))return[];let n=[],r="",s=!1;for(let e=1,i=t.length-1;e<i;++e){let i=t[e];if("-"!==i)s?(s=!1,r?(n.push([r,i]),r=""):n.push(i)):(r&&n.push(r),r=i);else{if(s)continue;s=!0}}return r&&n.push(r),s&&n.push("-"),n}function*Gt(e){for(let t=0,n=e.length;t<n;t++){let n=e[t];"string"==typeof n?yield n:yield*Ht(n[0],n[1])}}var Zt=rt("build_range",(e=>[...Gt(Vt(e))]));function Kt(e){return(...t)=>e(...t.flatMap((e=>String(e).startsWith("[")?Zt(e):e)))}var Jt=class{constructor(e){this.prev=this.next=null,this.data=e}},Qt=class{constructor(e=20){this._limit=e,this._size=0}push(e){this._size>=this._limit&&(this.root=this.root.next,this.root.prev=null);let t=new Jt(e);this.root?(t.prev=this.tail,this.tail.next=t,this.tail=t):this.root=this.tail=t,this._size++}last(e=1){let t=this.tail;for(;--e&&t.prev;)t=t.prev;return t.data}};function en(e,t){let n={},r=!0;for(let s=0;s<e.length;++s){let i=e[s],l=t[s];if(/=/.test(i)){let[e,s]=I(i,{symbol:"=",noSpace:!0});void 0!==s?(t.includes(e)&&(n[e]=s),r=!1):n[l]=i}else r&&(n[l]=i)}return n}var tn=1e-6;function nn(e,t,n,r){const s=3*e,i=3*(n-e)-s,l=1-s-i,a=3*t,o=3*(r-t)-a,u=1-a-o,c=(e,t,n,r)=>((e*r+t)*r+n)*r,h=(e,t,n,r)=>(3*e*r+2*t)*r+n;return e=>e<=0?0:e>=1?1:c(u,o,a,function(e){let t=e;for(let n=0;n<8;n++){const n=c(l,i,s,t)-e;if(Math.abs(n)<tn)return t;const r=h(l,i,s,t);if(Math.abs(r)<tn)break;t=Math.max(0,Math.min(1,t-n/r))}let n=0,r=1;for(let a=0;a<20;a++){t=(n+r)/2;const a=c(l,i,s,t);if(Math.abs(a-e)<tn)break;a<e?n=t:r=t}return t}(e))}var rn={ease:nn(.25,.1,.25,1),easeIn:nn(.42,0,1,1),easeOut:nn(0,0,.58,1),easeInOut:nn(.42,0,.58,1),linear:e=>e};function sn(e){if("function"==typeof e)return e;const t=String(e).trim(),n=rn[function(e){return e.trim().toLowerCase().replace(/[-\s]/g,"").replace(/(?<=ease|in|out)(in|out)/gi,(e=>e[0].toUpperCase()+e.slice(1)))}(t)];if(n)return n;const r=function(e){if(!/^cubic-bezier\s*\(/i.test(e))return null;const t=e.match(/-?[\d.]+/g)?.map(Number);return 4===t?.length&&t.every((e=>!isNaN(e)))?t:null}(t);return r?nn(...r):(s=t,e=>_t(s,{t:e}));var s}var ln=/^[\+\*\-\/%][\-\.\d\s]/,an=/[\+\*\-\/%]$/,on=/var\(/,un=/^calc\(/,cn=/^[a-zA-Z]/;function hn(e){return w(((t,n,...r)=>{if(!r||!n)return"";let s=j(n()),i=s;/\D/.test(s)&&!/\d+[x-]\d+/.test(s)&&(i=_t(s),0===i&&(i=s));let l=Math.random();return function(e,t){let[n,r=1]=String(e).split(/[x-]/),[s,i]=[Math.ceil(n),Math.ceil(r)];$(s)&&(s=1),$(i)&&(i=1),n=y(s,0,65536),r=y(i,0,65536);let l=n*r,a=[],o=1;if(/x/.test(e))for(let e=1;e<=r;++e)for(let s=1;s<=n;++s)a.push(t(o,s,e,l,n,r,o)),o++;else if(/-/.test(e))if(l=Math.abs(n-r)+1,n<=r)for(let e=n;e<=r;++e)a.push(t(e,e,1,l,l,1,o++));else for(let e=n;e>=r;--e)a.push(t(e,e,1,l,l,1,o++));else for(let e=1;e<=n;++e)a.push(t(e,e,1,n,n,1,o++));return a}(i,((...e)=>r.map((t=>j(t(...e,l)))).join(","))).join(e)}))}function pn(e,t,n){return e[t]||(e[t]=new Qt(1024)),e[t].push(n),n}function fn(e){return-1*e}function dn(e,t,n){switch(e){case"+":return t+n;case"-":return t-n;case"*":return t*n;case"/":return t/n;case"%":return t%n;default:return 0}}function mn(e,t){return[`calc(${e})`,t]}function gn(e,t){if(k(t)||k(e))return[];if(ln.test(t)){let n=t[0],{unit:r="",value:s}=Le(t.slice(1).trim()||0);return on.test(e)?mn("%"===n?`mod(${e}, ${s})`:`${e} ${n} ${s}`,r):[dn(n,Number(e),Number(s)),r]}if(an.test(t)){let n=t.slice(-1),{unit:r="",value:s}=Le(t.slice(0,-1).trim()||0);return on.test(e)?mn("%"===n?`mod(${s}, ${e})`:`${s} ${n} ${e}`,r):[dn(n,Number(s),Number(e)),r]}{let{unit:n="",value:r}=Le(t||0);return[Number(e)+(Number(r)||0),n]}}function vn(e){let t="";return(...n)=>{for(let r of n){let[n,s]=gn(e,r);e=n,!t&&s&&(t=s)}return un.test(e)?`calc(${e} * 1${t})`:e+t}}function yn(e){return(t="",...n)=>{if(cn.test(t)){return vn(sn(t)(e))(...n)}let r=[].concat(t,n).filter((e=>""!==e));return vn(e)(...r)}}function bn(e){return({count:t,extra:n,grid:r})=>{let s=z(n);return(...n)=>{let i=n.join(","),[l=t,a,o,u=r.count]=s||[],{points:c,rules:h}=Rt(i,{min:1,max:65536,count:u},(t=>(delete t.fill,delete t["fill-rule"],delete t.frame,t.split||t.points?t.hasPoints=!0:t.points=u,e&&(t.unit=t.unit||"none"),t)));return h.hasPoints?c:c[l-1]}}}function xn(e){let t=e?1:2;return()=>(...e)=>{for(let n=e.length-t;n>=0;--n)e.push(e[n]);return e}}function _n(e,t,n=!1){return({context:r,extra:s,upextra:i,position:l,shuffle:a},o)=>{let u=z(o&&i.length?i:s),c=u?z(u):"",h=o?e.toUpperCase():e,p=l+c,f=`${h}-counter${p}`,d=`${h}-values${p}`;return Kt(((...e)=>{r[f]||(r[f]=0),r[f]+=1;let s=e;n&&(r[d]||(r[d]=a(e||[])),s=r[d]);let i=e.length,l=u&&u[6];l??=r[f];let o=t(s,(l-1)%i,i);return pn(r,"last_pick",o)}))}}var $n=b({i:({count:e})=>vn(e),y:({y:e})=>vn(e),x:({x:e})=>vn(e),z:({z:e})=>vn(e),I:({grid:e})=>vn(e.count),Y:({grid:e})=>vn(e.y),X:({grid:e})=>vn(e.x),Z:({grid:e})=>vn(e.z),iI:({count:e,grid:t})=>yn(e/t.count),Ii:({count:e,grid:t})=>yn((t.count-e+1)/t.count),xX:({x:e,grid:t})=>yn(e/t.x),Xx:({x:e,grid:t})=>yn((t.x-e+1)/t.x),yY:({y:e,grid:t})=>yn(e/t.y),Yy:({y:e,grid:t})=>yn((t.y-e+1)/t.y),id:({x:e,y:t,z:n})=>r=>S(e,t,n),dx:({x:e,grid:t})=>vn(e-.5-t.x/2),dy:({y:e,grid:t})=>vn(e-.5-t.y/2),n({extra:e}){let t=z(e);return t?vn(t[0]):"@n"},nx({extra:e}){let t=z(e);return t?vn(t[1]):"@nx"},ny({extra:e}){let t=z(e);return t?vn(t[2]):"@ny"},nd({extra:e}){let t=z(e);if(t){let e=t[0],n=t[3];return t=>(t=Number(t)||0,vn(e-.5-t-n/2))}return"@nd"},N({extra:e}){let t=z(e);return t?vn(t[3]):"@N"},nN({extra:e}){let t=z(e);return t?yn(t[0]/t[3]):"@nN"},Nn({extra:e}){let t=z(e);if(t){let e=t[0],n=t[3];return yn((n-e+1)/n)}return"@Nn"},m:hn(","),M:hn(" "),"\xb5":hn(""),match({extra:e,x:t,y:n,z:r,count:s,grid:i}){let[l,a,o,u]=z(e)||[],c={x:t,y:n,z:r,i:s,I:i.count,X:i.x,Y:i.y,Z:i.z};return _(l)||(c.n=l),_(a)||(c.nx=a),_(o)||(c.ny=o),_(u)||(c.N=u),(...e)=>{if(e.length<=1)return"";if(e.length<=3){let[t,n,r=""]=e;return!!_t(t,c)?n:r}for(let t=0;t<e.length;t+=2){let n=e[t],r=e[t+1];if(_(r))return n;if(_t(n,c))return r}}},p:({context:e,pick:t})=>Kt(((...n)=>{n.length||(n=e.last_pick_args||[]);let r=t(n);return e.last_pick_args=n,pn(e,"last_pick",r)})),P({context:e,pick:t,position:n}){let r="P-counter"+n;return Kt(((...n)=>{let s=!0;n.length||(n=e.last_pick_args||[],s=!1);let i=e.last_pick,l=i?i.last(1):"";if(s&&(e[r]||(e[r]={}),l=e[r].last_pick),n.length>1){let e=n.findIndex((e=>e===l));-1!==e&&n.splice(e,1)}let a=t(n);return e.last_pick_args=n,s&&(e[r].last_pick=a),pn(e,"last_pick",a)}))},pl:_n("pl",((e,t)=>e[t])),PL:e=>$n.pl(e,!0),pr:_n("pr",((e,t,n)=>e[n-t-1])),PR:e=>$n.pr(e,!0),pd:_n("pd",((e,t)=>e[t]),!0),PD:e=>$n.pd(e,!0),lp:({context:e})=>(t=1)=>{let n=e.last_pick;return n?n.last(t):""},r:({context:e,rand:t})=>(...n)=>{let r=(n.length&&n.every(x)?Yt:qt)(t)(...n);return pn(e,"last_rand",r)},ri:({context:e,rand:t})=>(...n)=>{let r=(n.every(x)?Yt:qt)(((...e)=>Math.round(t(...e))))(...n);return pn(e,"last_rand",r)},rn({x:e,y:t,context:n,position:r,grid:s,extra:i,random:l}){let a="noise-2d"+r,o=a+"offset-x",u=a+"offset-y",[c,h,p,f,d,m]=z(i)||[],g=c&&f;return(...r)=>{let{from:i=0,to:c=i,frequency:f=1,scale:v=1,octave:b=1}=en(r,["from","to","frequency","scale","octave"]);f=y(f,0,1/0),v=y(v,0,1/0),b=y(b,1,100),1==r.length&&([i,c]=[0,i]),n[a]||(n[a]=new It(l)),n[o]||(n[o]=l()),n[u]||(n[u]=l());let _=x(i)&&x(c)?Yt:qt,$=n[a],k=n[o],w=n[u],S=(g?(h-1)/d:(e-1)/s.x)+k,j=(g?(p-1)/m:(t-1)/s.y)+w;(d<=1||s.x<=1)&&(S=k+.5),(m<=1||s.y<=1)&&(j=w+.5),0==S&&0==j&&(S=k,j=w);let A=$.noise(S*f,j*f,0)*v;for(let e=1;e<b;++e){let t=2*e;A+=$.noise(S*f*t,j*f*t,0)*(v/t)}let N=_(((e,t)=>function(e,t,n,r=1){let s=Math.sqrt(.5)*r,i=(e+s)/(2*s);return i=y(i,0,1),C(i,t*r,n*r)}(A,e,t,v)));return pn(n,"last_rand",N(i,c))}},lr:({context:e})=>(t=1)=>{let n=e.last_rand;return n?n.last(t):""},stripe:()=>(...e)=>{let t,n=e.map(j).flat(),r=n.length,s=0,i=[];if(!r)return"";n.forEach((e=>{let[t,n]=I(e);void 0!==n?i.push(n):s+=1}));let l=i.length?`(100% - ${i.join(" - ")}) / ${s}`:`100% / ${r}`;return n.map(((e,n)=>{if(i.length){let[n,r]=I(e);return t=(t?t+" + ":"")+(void 0!==r?r:l),`${n} 0 calc(${t})`}return`${e} 0 ${100/r*(n+1)}%`})).join(",")},calc:()=>(e,t)=>_t(j(e),t),hex:()=>e=>parseInt(j(e)).toString(16),svg:w(((e,...t)=>{let n=t.map((e=>j(e()))).join(",");if(!n.startsWith("<")){n=Ge(K(n))}return Be(Xe(n))})),"svg-filter":w(((e,...t)=>{let n=t.map((e=>j(e()))),r=n.join(","),s=R("filter-");if(n.every((e=>/^[\-\d.]/.test(e)||/^(\w+)/.test(e)&&!/[{}<>]/.test(e)))){let{frequency:t,scale:s,octave:i,seed:l=e.seed,blur:a,erode:o,dilate:u}=en(n,["frequency","scale","octave","seed","blur","erode","dilate"]);if(r="\n x:-20%;y:-20%;width:140%;height:140%;",_(u)||(r+=`\n feMorphology{operator:dilate;radius:${u};}`),_(o)||(r+=`\n feMorphology{operator:erode;radius:${o};}`),_(a)||(r+=`\n feGaussianBlur{stdDeviation:${a};}`),!_(t)){let[e,n=e]=I(t);i=i?`numOctaves:${i};`:"",r+=`\n feTurbulence{type:fractalNoise;baseFrequency:${e} ${n};seed:${l};${i}}`,s&&(r+=`\n feDisplacementMap{in:SourceGraphic;scale:${s};}`)}}if(!r.startsWith("<")){r=Ge(K(r,{type:"block",name:"filter"}))}return Be(Xe(r).replace(/<filter([\s>])/,`<filter id="${s}"$1`),s)})),"svg-pattern":w(((e,...t)=>{let n=t.map((e=>j(e()))).join(",");return Be(Ge(K(`\n viewBox:0 0 1 1;preserveAspectRatio:xMidYMid slice;rect{width, height:100%;fill:defs pattern{${n}}}`)))})),"svg-polygon":w(((e,...t)=>{let n=t.map((e=>j(e()))).join(","),{rules:r,points:s}=Rt(n,{min:3,max:65536},(e=>(delete e.frame,e.unit="none",e["stroke-width"]??=.01,e.stroke??="currentColor",e.fill??="none",e))),i=`points:${s};`,l="",a=r.padding??Number(r["stroke-width"])/2;for(let e of Object.keys(r))/^(stroke|fill|clip|marker|mask|animate|draw)/.test(e)&&(l+=`${e}:${r[e]};`);return Be(Ge(K(`\n viewBox:-1 -1 2 2 p ${a};polygon{${l} ${i}}`)))})),linearGradient:w(((e,...t)=>Mt("linearGradient",t))),radialGradient:w(((e,...t)=>Mt("radialGradient",t))),var:()=>e=>`var(${j(e)})`,ut:()=>vn(`var(--${Lt.name})`),ts:()=>vn(`calc(var(--${Lt.name}) / 1000)`),TS:()=>vn(`calc(var(--${Ut.name}) / 1000)`),UT:()=>vn(`var(--${Ut.name})`),uw:()=>vn(`var(--${Bt})`),uh:()=>vn(`var(--${Xt})`),ux:()=>vn(`var(--${Dt})`),uy:()=>vn(`var(--${Ft})`),plot:bn(!1),Plot:bn(!0),shape:()=>rt("shape-function",((...e)=>{let t=e.join(","),{points:n}=Rt(t);return`polygon(${n.join(",")})`})),doodle:()=>e=>e,shaders:()=>e=>e,pattern:()=>e=>e,invert:()=>e=>{let t=We(e);return t.valid?t.commands.map((({name:e,value:t})=>{switch(e){case"v":return"h"+t.join(" ");case"V":return"H"+t.join(" ");case"h":return"v"+t.join(" ");case"H":return"V"+t.join(" ");default:return e+t.join(" ")}})).join(" "):e},flipH:()=>e=>{let t=We(e);return t.valid?t.commands.map((({name:e,value:t})=>{switch(e){case"h":case"H":return e+t.map(fn).join(" ");default:return e+t.join(" ")}})).join(" "):e},flipV:()=>e=>{let t=We(e);return t.valid?t.commands.map((({name:e,value:t})=>{switch(e){case"v":case"V":return e+t.map(fn).join(" ");default:return e+t.join(" ")}})).join(" "):e},flip(...e){let t=$n.flipH(...e),n=$n.flipV(...e);return e=>n(t(e))},reverse:()=>(...e)=>{let t=e.map(j),n=We(t.join(","));if(n.valid){let e=[];for(let t=n.commands.length-1;t>=0;--t){let{name:r,value:s}=n.commands[t];e.push(r+s.join(" "))}return e.join(" ")}return t.reverse()},cycle:()=>(...e)=>{let t,n=[];1==(e=e.map((e=>"<"+e+">"))).length?(t=" ",n=I(e[0],{symbol:t})):(t=",",n=I(e.map(j).join(t),{symbol:t})),n=n.map((e=>e.replace(/^\<|>$/g,"")));let r=n.length,s=[];for(let e=0;e<r;++e){let r=n.slice(e).concat(n.slice(0,e));s.push(r.join(t))}return s},mirror:xn(!0),Mirror:xn(!1),code:()=>(...e)=>e.map((e=>String.fromCharCode(e))),once:w((({context:e,extra:t,position:n},...r)=>{let s="once-counter"+n;return e[s]??=r.map((e=>j(e()))).join(",")})),raw:({rules:e})=>(...t)=>{let n=t.join(",");try{let t=n.substring(n.indexOf(",")+1,n.lastIndexOf('")'));if(n.startsWith("${doodle")&&n.endsWith("}")){let t=n.substring(2,n.length-1),r=e.doodles;if(r&&r[t])return`<css-doodle>${r[t].doodle}</css-doodle>`}if(n.startsWith('url("data:image/svg+xml;utf8'))return decodeURIComponent(t);if(n.startsWith('url("data:image/svg+xml;base64'))return atob(t);if(n.startsWith('url("data:image/png;base64'))return`<img src="${n}" alt="" />`}catch(e){}return n},"google-font":()=>e=>({value:e,gf:!0})},{index:"i",col:"x",row:"y",depth:"z",rand:"r",pick:"p",pn:"pl",pnr:"pr",PN:"PL",PNR:"PR",R:"rn",T:"UT",t:"ut",stripes:"stripe",strip:"stripe",patern:"pattern",flipv:"flipV",fliph:"flipH",filter:"svg-filter","last-rand":"lr","last-pick":"lp",multiple:"m",multi:"m",rep:"\xb5",repeat:"\xb5",ms:"M",s:"I",size:"I",sx:"X","size-x":"X","size-col":"X","max-col":"X",sy:"Y","size-y":"Y","size-row":"Y","max-row":"Y",sz:"Z","size-z":"Z","size-depth":"Z",Svg:"svg","pick-by-turn":"pl","pick-n":"pl","pick-d":"pd",offset:"plot",Offset:"Plot",point:"plot",Point:"Plot",unicode:"code"}),kn=$n,wn={a0:[841,1189],a1:[594,841],a2:[420,594],a3:[297,420],a4:[210,297],a5:[148,210],a6:[105,148],postcard:[100,148],poster:[390,540]},Sn={portrait:"p",pt:"p",p:"p",landscape:"l",ls:"l",l:"l"};var jn="--_cell-width",An="--_cell-height",Nn={center:"50%",left:"0%",right:"100%",top:"50%",bottom:"50%"},En={center:"50%",top:"0%",bottom:"100%",left:"50%",right:"50%"},Tn=b({size(e,{is_special_selector:t,grid:n}){let[r,s=r,i]=I(e);wn[r]&&([r,s]=function(e,t){e=String(e).toLowerCase();let[n,r]=wn[e]??[];return"p"==Sn[t]&&([r,n]=[n,r]),[r,n].map((e=>e+"mm"))}(r,s));let l=`width:${r};height:${s};`;return"auto"!==r&&"auto"!==s||(i&&(/^\(.+\)$/.test(i)?i=i.substring(1,i.length-1):/^calc/.test(i)||(i=`calc(${i})`),t||(l+=`aspect-ratio:${i};`)),t&&(l+=`aspect-ratio:${i||n.ratio};`)),t||(l+=`${jn}:${r};${An}:${s};`),l},place(e,{extra:t}){let[n,r="50%"]=I(e);n=Nn[n]||n,r=En[r]||r;let s=`var(${jn}, 25%)`,i=`var(${An}, 25%)`;return`\n position:absolute;left:${n};top:${r};width:${s};height:${i};margin-left:calc(${s} / -2);margin-top:calc(${i} / -2);grid-area:unset;${t?`rotate:${t||0}deg;`:""}`},grid(e,t){let n={clip:!0,p3d:!1},r=[],s=0;for(let i of I(e,{symbol:" "}))0!==s||"|"!==i&&"-"!==i?/border:?/i.test(i)?(n.borderLegacy=i.split(":")[1]||"",r.push("\xa7")):/^no\-*clip$/i.test(i)?(n.clip=!1,r.push("\xa7")):/^p3d$/i.test(i)?(n.p3d=!0,r.push("\xa7")):(n.grid||(n.grid=Ce(i,t.max_grid)),r.push(i)):(n.flex="|"===i?"column":"row",r.push("\xa7")),s+=1;let i=I(r.join(" "),{symbol:["/ 2","+","^","*","~","\u2206","_","\xdf","\u03b2","\xab","\xa7"],noSpace:!0,verbose:!0});for(let{group:e,value:r}of i){if("+"===e&&(n.scale=r),"^"===e&&(n.enlarge=I(r,{symbol:" "})),"~"===e&&(n.translate=r),"\u2206"===e&&(n.persp=I(r,{symbol:" "})),"_"===e&&(n.gap=r),"*"===e){let[e,...t]=I(r,{symbol:" "});"h"==e?n.hueRotate=t.join(" "):n.rotate=r}if("/"===e&&(void 0===n.size?n.size=this.size(r,t):n.fill=r),"\u03b2"===e||"\xdf"===e){let e=I(r,{symbol:" "});for(let t=0;t<e.length;t++)if(Number(e[t])){e[t]+="px";break}let t=e[0];1!==e.length||!/^\D/.test(t)||/^\.\d/.test(t)||/^(thin|thick|medium)$/.test(t)||e.push("1px"),/solid|dotted|dashed|double|groove|ridge|inset|outset/.test(r)||e.push("solid"),n.border=e.join(" ")}"\xab"===e&&(n.backdropFilter=r),""!==e||n.grid||(n.grid=Ce(r,t.max_grid))}return n},gap:e=>e,seed:e=>e,shape:rt("shape-property",(e=>{let{points:t,preset:n}=Rt(e);return n?`clip-path:polygon(${t.join(",")});`:""})),use(e){if(e.length>2)return e},content:e=>e},{"place-cell":"place",offset:"place",position:"place"});function Cn(e,t){return"+"===t?e:"-"===t?-1*e:e}function Rn(e){return e.reduce(((e,t)=>e+t),0)}function Mn(e){return!!(e%2)}function Pn(e){return!Mn(e)}function zn(e){let t="";return t=0==e?"$:hover":e>0?`$:hover ${"+*".repeat(e)}`:`:has(+ ${"*+".repeat(Math.abs(e+1))} $:hover)`,t}function On(e,t,n,s){let i=null==n||null==s;if("even"===e)return{value:i?Pn(t):Mn(n+s)};if("odd"===e)return{value:i?Mn(t):Pn(n+s)};if("n"===e)return{value:!0};let{a:l,b:a,error:o}=function(e){let t,n,s=r(p(e)),i=[],l=[];for(;s.next();){let{prev:e,curr:r,next:a}=s.get(),o=r.value;if(r.isSymbol()){if("+"!==o&&"-"!==o){n="Unexpected "+r.value;break}t=o}else if(r.isNumber()){if((i.length||l.length)&&!t){n="Syntax error";break}if(o=Cn(Number(o),t),t=null,a&&"n"===a.value){i.push(o),s.next();continue}l.push(o)}else if("n"===o){if((i.length||l.length)&&!t){n="Syntax error";break}i.push(Cn(1,t)),t=null}else if(!r.isSpace()){n="Unexpected "+o;break}}return n?{a:0,b:0,error:n}:{a:Rn(i),b:Rn(l)}}(e);if(o)return{value:!1,error:o};if(0===l)return{value:t===a};{let e=(t-a)/l;return{value:e>=0&&Number.isInteger(e)}}}function In(e,t,n){t>e&&(t=e);const r=new Map,s=[];for(let i=0;i<t;i++){const t=Math.floor(n()*(e-i))+1,l=r.get(t)??t,a=r.get(e-i)??e-i;r.set(t,a),s.push(l)}return s}var Wn=b({at:({x:e,y:t})=>(n,r)=>e==n&&t==r,nth:({count:e,grid:t})=>(...t)=>{for(let n of t)if(On(n,e).value)return!0;return!1},y:({y:e,grid:t})=>(...t)=>{for(let n of t)if(On(n,e).value)return!0;return!1},x:({x:e,grid:t})=>(...t)=>{for(let n of t)if(On(n,e).value)return!0;return!1},even:({x:e,y:t})=>n=>Mn(e+t),odd:({x:e,y:t})=>n=>Pn(e+t),random({random:e,count:t,x:n,y:r,grid:s,context:i,position:l}){let a="random-cells"+l;return(l=.5)=>{let o=l;return/\D/.test(o)&&(o=_t("(0 + "+o+")",{x:n,X:s.x,y:r,Y:s.y,i:t,I:s.count,random:e})),o>=s.count||!(o<=0)&&(o>=1?(i[a]||(i[a]=In(s.count,o,e)),i[a].includes(t)):e()<l)}},match:({count:e,grid:t,x:n,y:r,random:s})=>i=>!!_t("("+i+")",{x:n,X:t.x,y:r,Y:t.y,i:e,I:t.count,random:s}),cell({count:e,grid:t,x:n,y:r,random:s,context:i,position:l}){let a="random-cells"+l;return(...l)=>{if(!l.length)return!0;return l.map((l=>{let{value:o,error:u}=On(l,e,n,r);if(!u)return o;if(l.startsWith("random")){let n=l.slice(6).trim();if(!n)return s()<.5;if(n=Number(n),!Number.isNaN(n))return n>=1?(i[a]||(i[a]=In(t.count,n,s)),i[a].includes(e)):s()<n}return!!_t("("+l+")",{x:n,X:t.x,y:r,Y:t.y,i:e,I:t.count,random:s})})).some(Boolean)}},hover:({count:e,x:t,y:n,grid:r,random:s})=>(...e)=>{let s=[];e.length||s.push(zn(0));for(let i of e){let[e,l]=String(i).split(/\s+/);if(e=Number(e),l=Number(l),Number.isNaN(l)&&!Number.isNaN(e)&&s.push(zn(e)),!Number.isNaN(e)&&!Number.isNaN(l)){let i=e+t,a=l+n;if(i>=1&&i<=r.x&&a>=1&&a<=r.y){let t=l*r.y+e;s.push(zn(t))}}}return!!s.length&&{selector:s.join(",")}}},{col:"x",row:"y"}),Ln=256,Un=255,Dn=Ln**6,Fn=2**52,Bn=2*Fn;function Xn(e){let t,n=0,r=0;const s=this.S=[];for(e.length||(e=[0]);n<Ln;)s[n]=n++;for(n=0;n<Ln;n++)t=s[n],r=Un&r+e[n%e.length]+t,s[n]=s[r],s[r]=t;this.i=this.j=0,this.g(Ln)}function qn(e,t=3){return t&&"object"==typeof e?Object.values(e).map((e=>qn(e,t-1))).join(""):"string"==typeof e?e:e+"\0"}function Yn(e){const t=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++)t[Un&r]=Un&(n^=19*t[Un&r])+e.charCodeAt(r);return t}(null==e?function(){try{const e=new Uint8Array(Ln);return crypto.getRandomValues(e),String.fromCharCode(...e)}catch{return Date.now()+""+Math.random()}}():qn(e)),n=new Xn(t),r=()=>{let e=n.g(6),t=Dn,r=0;for(;e<Fn;)e=(e+r)*Ln,t*=Ln,r=n.g(1);for(;e>=Bn;)e/=2,t/=2,r>>>=1;return(e+r)/t};return r.int32=()=>0|n.g(4),r.quick=()=>n.g(4)/4294967296,r}Xn.prototype.g=function(e){let t,{i:n,j:r,S:s}=this,i=0;for(;e--;)t=s[n=Un&n+1],i=i*Ln+s[Un&(s[n]=s[r=Un&r+t])+(s[r]=t)];return this.i=n,this.j=r,i};var Hn=(new Date).setHours(0,0,0,0)-Date.now();function Vn(e){return/^\:(host|doodle)/.test(e)}function Gn(e){return/^\:container/.test(e)}function Zn(e){return Vn(e)||Gn(e)}var Kn={};for(let e of Object.getOwnPropertyNames(Math))Kn[e]=()=>(...t)=>"number"==typeof Math[e]?Math[e]:(t=t.map((e=>_t(j(e)))),Math[e](...t));var Jn=class{constructor(e){this.tokens=e,this.rules={},this.props={},this.keyframes={},this.grid=null,this.seed=null,this.is_grid_set=!1,this.is_gap_set=!1,this.coords=[],this.doodles={},this.pattern={},this.shaders={},this.vars={},this.uniforms={},this.content={},this.reset()}reset(){this.styles={host:"",container:"",cells:"",backdrop:"",keyframes:"",top:"",gf:[]},this.coords=[],this.doodles={},this.pattern={},this.shaders={},this.content={},this.vars={};for(let e in this.rules)e.startsWith("#c")&&delete this.rules[e]}add_rule(e,t){let n=this.rules[e];return n||(n=this.rules[e]=[]),!!t&&((":top:"!==e&&":gf:"!==e||!n.includes(t))&&void(this.rules[e]=n.concat(t)))}pick_func(e){return e.startsWith("$")&&(e="calc"),kn[e]||Kn[e]}apply_func(e,t,n,r,s={}){let i=e(...M(t)),l=[];if(n.forEach((e=>{let t=typeof e.value;if(e.cluster||"number"!==t&&"string"!==t){if("function"==typeof e)l.push(e);else if(!_(e.value)){let t=j(e.value);l.push(t)}}else l.push(...I(e.value,{noSpace:!0}))})),l=M(l.filter((e=>!_(e)&&String(e).trim().length))),"function"==typeof i){if(r.startsWith("$")){let e=Object.assign({},this.vars.host,this.vars.container,this.vars[t.count],s),n={},a="";for(let[t,r]of Object.entries(e))n[t.slice(2)]=r;return r.length>1&&(a=r.split("$")[1]??""),i(l,n)+a}return i(...l)}return i}compose_aname(...e){return e.join("-")}compose_selector({x:e,y:t,z:n},r=""){return`#${S(e,t,n)}${r}`}is_composable(e){return["doodle","shaders","pattern"].includes(e)}read_var(e,t,n){let r=t.count,s=Object.assign({},this.vars.host,this.vars.container,this.vars[r],n);if(void 0!==s[e]){let t=String(s[e]).trim();if("("==t[0]){")"===t[t.length-1]&&(t=t.substring(1,t.length-1))}return t.replace(/;+$/g,"")}return e}compose_argument(e,t,n=[],r,s,i){t.extra||(t.extra=[]),t.extra.push(n);let l=e.map((e=>{if("text"===e.type)return/^\-\-\w/.test(e.value)?r&&"@var"===r.name?e.value:this.read_var(e.value,t,s):e.value;if("func"===e.type){let r=e.name.slice(1),l=this.pick_func(r);if("function"==typeof l){if(this.check_uniforms(r),this.is_composable(r)){let n,s=j((e.arguments[0]||[])[0]);if(/^\d/.test(s)&&(n=s,s=j((e.arguments[1]||[])[0])),!_(s))switch(r){case"doodle":return this.compose_doodle(this.inject_variables(s,t.count),n,structuredClone(t.extra));case"shaders":return this.compose_shaders(s,t,n,i);case"pattern":return this.compose_pattern(s,t,n,i)}}t.position=e.position;let a=e.arguments.map((r=>l.lazy?(...n)=>this.compose_argument(r,t,n,e,s,i):this.compose_argument(r,t,n,e,s,i))),o=this.apply_func(l,t,a,r,s);return o&&o.gf&&this.add_rule(":gf:",o.value),j(o)}return e.name}}));return t.extra.pop(),{cluster:e.cluster,value:l.length>=2?{value:l.join("")}:l[0]}}compose_doodle(e,t,n){let r=R("doodle");return this.doodles[r]={doodle:e,arg:t,upextra:n},"${"+r+"}"}get_target(e,t){let n={selector:"cell",type:"background"};return e&&"@content"===e.property?n.type="content":e&&"@grid"===e.property?n.selector=":host":Zn(e)&&(n.selector=e),"cell"===n.selector&&(n.selector=t),n}compose_shaders(e,{x:t,y:n,z:r},s,i){let l=R("shader"),a=S(t,n,r),o=this.get_target(i,a);return this.shaders[l]={shader:e,target:o,arg:s,id:"--"+l,cell:a},"${"+l+"}"}compose_pattern(e,{x:t,y:n,z:r},s,i){let l=R("pattern"),a=S(t,n,r),o=this.get_target(i,a);return this.pattern[l]={code:e,target:o,arg:s,id:"--"+l,cell:a},"${"+l+"}"}check_uniforms(e){switch(e){case"ut":case"UT":case"t":case"T":case"ts":case"TS":this.uniforms.time=!0;break;case"ux":this.uniforms.mousex=!0;break;case"uy":this.uniforms.mousey=!0;break;case"uw":this.uniforms.width=!0;break;case"uh":this.uniforms.height=!0;break;case"shaders":this.uniforms.mouse=!0}}inject_variables(e,t){let n=Object.assign({},this.vars.host,this.vars.container,this.vars[t]),r=[];for(let[e,t]of Object.entries(n))r.push(`${e}:${t};`);return r=r.join(""),r.length?`:doodle{${r}}`+e:e}compose_variables(e,t,n={}){for(let[r,s]of Object.entries(e))n[r]=this.get_composed_value(s,t,n).value;return n}compose_value(e,t,n={},r){if(!Array.isArray(e))return{value:"",extra:""};let s="";return{value:e.reduce(((e,i)=>{switch(i.type){case"text":e+=i.value;break;case"func":{let l=i.name.slice(1),a=this.pick_func(l);if("function"==typeof a)if(this.check_uniforms(l),this.is_composable(l)){let n,s=j((i.arguments[0]||[])[0]);if(this.is_composable(l)&&/^\d/.test(s)&&(n=s,s=j((i.arguments[1]||[])[0])),!_(s))switch(l){case"doodle":e+=this.compose_doodle(this.inject_variables(s,t.count),n,structuredClone(t.extra));break;case"shaders":e+=this.compose_shaders(s,t,n,r);break;case"pattern":e+=this.compose_pattern(s,t,n,r)}}else{t.position=i.position,i.variables&&this.compose_variables(i.variables,t,n);let o=i.arguments.map((e=>a.lazy?(...s)=>this.compose_argument(e,t,s,i,n,r):this.compose_argument(e,t,[],i,n,r))),u=this.apply_func(a,t,o,l,n);_(u)||(e+=j(u),u.extra&&(s=u.extra),u&&u.gf&&this.add_rule(":gf:",u.value))}else e+=i.name}}return e}),""),extra:s}}get_composed_value(e,t,n,r){let s,i=[];return Array.isArray(e)&&(i=e.reduce(((e,i)=>{let l=this.compose_value(i,t,n||{},r);return l&&(l.value&&e.push(l.value),l.extra&&(s=l.extra)),e}),[])),{extra:s,group:i,value:i.join(",")}}add_grid_style({fill:e,clip:t,rotate:n,hueRotate:r,scale:s,translate:i,enlarge:l,skew:a,persp:o,flex:u,p3d:c,border:h,borderLegacy:p,gap:f,backdropFilter:d}){if(e&&this.add_rule(":host",`background:${e};`),t||this.add_rule(":host","contain:none;"),n&&(/[0-9]$/.test(n)&&(n+="deg"),this.add_rule(":container",`rotate:${n};`)),r&&(/[0-9]$/.test(r)&&(r+="deg"),this.add_rule(":host",`filter:hue-rotate(${r});`)),s&&this.add_rule(":container",`scale:${s};`),i&&this.add_rule(":container",`translate:${i};`),o){let[e,...t]=o;this.add_rule(":host",`perspective:${e};`),t.length&&this.add_rule(":host",`perspective-origin:${t.join(" ")};`)}if(l){let[e,t=e]=l,n=`calc(${e} + 100%)`,r=`calc(${t} + 100%)`;/[0-9]$/.test(e)&&(n=`calc(${e} * 100%)`),/[0-9]$/.test(t)&&(r=`calc(${t} * 100%)`),this.add_rule(":container",`\n width:${n};height:${r};left:50%;top:50%;transform-origin:0 0;transform:translate(-50%, -50%);`)}if(u&&(this.add_rule(":container","display:flex;"),this.add_rule("cell","flex:1;"),"column"===u&&this.add_rule(":container","flex-direction:column;")),c){let e="transform-style:preserve-3d;";this.add_rule(":host",e),this.add_rule(":container",e)}void 0!==p&&this.add_rule(":host",`border:1px solid ${p};`),void 0!==h&&this.add_rule(":host",`border:${h};`),f&&this.add_rule(":container",`gap:${f};`),d&&this.add_rule("b",`\n backdrop-filter:${d};`)}compose_rule(e,t,n){let r=Object.assign({},t),s=e.property;if("@seed"===s)return"";let i=this.get_composed_value(e.value,r,{},n),l=i.extra,a=i.value;if(/^animation(\-name)?$/.test(s)){if(this.props.has_animation=!0,Vn(n)){let e=Lt.n+","+Ut.n;e&&a&&(a=e+","+a)}if(r.count>1){let{count:e}=r;switch(s){case"animation-name":a=i.group.map((t=>this.compose_aname(t,e))).join(",");break;case"animation":a=i.group.map((t=>{let n=(t||"").split(/\s+/);return n[0]=this.compose_aname(n[0],e),n.join(" ")})).join(",")}}}if("content"===s){/["']|^none\s?$|^(var|counter|counters|attr|url)\(/.test(a)||(a=`'${a}'`);let e=new Map;return a=a.replace(/var\(\-\-cssd\-u(time|mousex|mousey|width|height)\)/gi,((t,n)=>(e.set(n,`${n} calc(${t})`),`counter(${n})`))),`\n ${e.size?`counter-reset:${Array.from(e.values()).join(" ")};`:""} content:${a};`}"transition"===s&&(this.props.has_transition=!0);let o=`${s}:${a};`;if("width"!==s&&"height"!==s||Zn(n)||(o+=`--_cell-${s}:${a};`),/^background(\-image)?$/.test(s)&&/\$\{(shader|pattern)/.test(a)&&(o+="background-size:100% 100%;"),/^\-\-/.test(s)&&this.compose_vars(t,n,s,a),/^@/.test(s)&&Tn[s.slice(1)]){let t=s.slice(1),i=Tn[t](a,{is_special_selector:Zn(n),grid:r.grid,max_grid:r.max_grid,extra:l});switch(t){case"grid":Vn(n)?(o=i.size||"",this.add_grid_style(i)):(o="",this.is_grid_set||(i=Tn[t](a,{is_special_selector:!0,grid:r.grid,max_grid:r.max_grid}),this.add_rule(":host",i.size||""),this.add_grid_style(i))),this.grid=r.grid,this.is_grid_set=!0;break;case"gap":o="",this.is_gap_set||(this.add_rule(":container",`gap:${i};`),this.is_gap_set=!0);break;case"content":{o="";let e=this.compose_selector(r);void 0===i||/\:before|\:after/.test(n)||Gn(n)||(this.content[e]=function(e){if(e.startsWith('"')&&e.endsWith('"')||e.startsWith("'")&&e.endsWith("'"))return e.substring(1,e.length-1);return e}(String(i))),this.content[e]=kn.raw({rules:{doodles:this.doodles}})(this.content[e]||"")}case"seed":o="";break;case"place-cell":case"place":case"position":case"offset":Vn(n)||(o=i);break;case"use":e.value.length&&this.compose(r,e.value),o="";break;default:o=i}}return/^grid/.test(s)&&Vn(n)&&(this.add_rule(":container",`${s}:${a};`),o=""),o}get_raw_value(e){let t=e.raw()??"",[n,...r]=t.split(e.property);return r=r.join(e.property).replace(/^\s*:\s*/,"").replace(/[;}<]$/,"").trim().replace(/[;}<]$/,""),r}compose_vars(e,t,n,r){let s=e.count;Gn(t)&&(s="container"),Vn(t)&&(s="host"),this.vars[s]||(this.vars[s]={}),this.vars[s][n]=r}pre_compose_rule(e,t,n){let r=Object.assign({},t),s=e.property,i=Object.assign({},this.vars.host,this.vars.container,this.vars[r.count]);if(/^\-\-/.test(s)){let l=this.get_composed_value(e.value,r,i,n).value;this.compose_vars(t,n,s,l)}switch(s){case"@grid":{let l=this.get_composed_value(e.value,r,i,n).value,a=s.slice(1),o=Tn[a](l,{max_grid:t.max_grid});this.grid=o.grid;break}case"@use":e.value.length&&this.pre_compose(r,e.value)}}pre_compose(e,t){_(this.seed)&&(t||this.tokens).forEach((e=>{if("rule"===e.type&&"@seed"===e.property&&(this.seed=this.get_raw_value(e)),"pseudo"===e.type&&Vn(e.selector))for(let t of M(e.styles))"rule"===t.type&&"@seed"===t.property&&(this.seed=this.get_raw_value(t))})),(t||this.tokens).forEach((t=>{switch(t.type){case"rule":this.pre_compose_rule(t,e);break;case"pseudo":Vn(t.selector)&&(t.styles||[]).forEach((t=>{this.pre_compose_rule(t,e,t.selector)}))}})),this.seed&&e.update_random(this.seed)}compose_cond(e,t){let n=e.name+" "+e.segments.map((e=>{if(e.keyword)return e.keyword;let n=e.arguments;if(Array.isArray(n)){return"("+n.map((e=>this.compose_argument(e,t).value)).join(", ")+")"}return""})).join(" "),r="";return e.styles.forEach((e=>{"rule"===e.type&&(r+=this.compose_rule(e,t)),"pseudo"===e.type&&e.name&&e.name.split(",").forEach((n=>{let s=e.styles.map((e=>this.compose_rule(e,t,n)));r+=`${(cond.selector+n).replaceAll("$",this.compose_selector(t))}{${s}}`})),"cond"===e.type&&(r+=this.compose_cond(e,t))})),`${n}{${r}}`}compose(e,t,n){this.coords.push(e),(t||this.tokens).forEach(((t,r)=>{if(t.skip)return!1;if(n&&this.grid)return!1;if("@gap"===t.property&&this.is_gap_set)return!1;if("@grid"===t.property&&this.is_grid_set)return!1;switch(t.type){case"rule":this.add_rule(this.compose_selector(e),this.compose_rule(t,e,t));break;case"pseudo":{t.selector.startsWith(":doodle")&&(t.selector=t.selector.replace(/^\:+doodle/,":host"));let n=Zn(t.selector);n&&(t.skip=!0),I(t.selector).forEach((r=>{let s=n?r:this.compose_selector(e,r);t.styles.forEach((t=>{if("rule"===t.type&&this.add_rule(s,this.compose_rule(t,e,r)),"pseudo"===t.type){let n=t.styles.map((t=>this.compose_rule(t,e,s))),r=s+t.selector;this.add_rule(r,n)}if("cond"===t.type&&t.name.startsWith("&")){let n=t.styles.map((t=>this.compose_rule(t,e,s))).join("");this.add_rule(s,t.name+"{"+n+"}")}}))}));break}case"cond":{let n=t.name.slice(1),r=Wn[n],s=[];if(r){let i=t.segments.find((e=>e.arguments));i&&i.arguments&&(s=i.arguments.map((t=>this.compose_argument(t,e)))),e.position=t.position;let l=this.apply_func(r,e,s,n);t.segments&&t.segments[0]&&"not"===t.segments[0].keyword&&(l=!l),l&&(l.selector?t.styles.forEach((t=>{"rule"===t.type&&this.add_rule(l.selector.replaceAll("$",this.compose_selector(e)),this.compose_rule(t,e)),"pseudo"===t.type&&t.selector&&t.selector.split(",").forEach((n=>{let r=t.styles.map((t=>this.compose_rule(t,e,n)));this.add_rule((l.selector+n).replaceAll("$",this.compose_selector(e)),r)}))})):this.compose(e,t.styles))}else this.add_rule(":top:",this.compose_cond(t,e));break}case"keyframes":this.keyframes[t.name]||(this.keyframes[t.name]=e=>`\n ${P(t.steps.map((t=>`\n ${this.get_composed_value(t.name,e).value}{${P(t.styles.map((t=>this.compose_rule(t,e))))}}`)))}`);break;case"at-rule":this.add_rule(":top:",t.value)}}))}output(){for(let[e,t]of Object.entries(this.rules))if(Gn(e)){let n=e.replace(/^:container\(?/,"grid").replace(/\)?$/,"");this.styles.container+=`${n}{${P(t)}}`}else if(":top:"===e)this.styles.top+=P(t);else if(":gf:"===e)this.styles.gf=t;else{let n=Vn(e)?"host":"cells";"b"===e&&(n="backdrop");let r=P(t).trim();if(r.length){let t="host"===n?`${e},.host`:e;this.styles[n]+=`${t}{${r}}`}}if(this.uniforms.time){let e="animation-name",t=Lt.ticks,n=Lt.name,r=Ut.name;this.styles.container+=`\n:host,.host{animation:${Lt.animation()},${Ut.animation(Hn+"ms")};}`,this.styles.keyframes+=`\n @keyframes ${Lt[e]}{from{--${n}:0} to{--${n}:${t}}} @keyframes ${Ut[e]}{from{--${r}:0} to{--${r}:${t}}}`}this.coords.forEach(((e,t)=>{for(let[n,r]of Object.entries(this.keyframes)){let s=this.compose_aname(n,e.count);this.styles.keyframes+=`\n ${0===t?`@keyframes ${n}{${r(e)}}`:""} @keyframes ${s}{${r(e)}}`}}));let{keyframes:e,host:t,container:n,cells:r,backdrop:s,top:i,gf:l}=this.styles,a=e+t+n;return{props:this.props,styles:{main:a,cells:r,container:n,backdrop:s,gf:l,top:i,all:a+s+r},grid:this.grid,seed:this.seed,random:this.random,doodles:this.doodles,shaders:this.shaders,pattern:this.pattern,uniforms:this.uniforms,content:this.content}}};function Qn(e,t,n,r,s,i=[]){let l=new Jn(e),a=s||Yn(String(n)),o={};function u(e=0,t=1){return 1==arguments.length&&([e,t]=[0,e]),C(a(),e,t)}function c(...e){let t=e.reduce(((e,t)=>e.concat(t)),[]);return t[~~(a()*t.length)]}function h(e){let t=[...e],n=e.length;for(;n;){let e=~~(a()*n--),r=t[n];t[n]=t[e],t[e]=r}return t}l.pre_compose({x:1,y:1,z:1,count:1,context:{},grid:{x:1,y:1,z:1,count:1},random:a,rand:u,pick:c,shuffle:h,max_grid:r,update_random:function(e){a=Yn(String(e))},seed_value:n,rules:l,upextra:i});let{grid:p,seed:f}=l.output();if(p&&(t=p),f?(f=String(f),a=Yn(f)):f=n,_(f)&&(f=Date.now(),a=Yn(f)),f=String(f),l.seed=f,l.random=a,l.reset(),1==t.z)for(let e=1,n=0;e<=t.y;++e)for(let s=1;s<=t.x;++s)l.compose({x:s,y:e,z:1,count:++n,grid:t,context:o,rand:u,pick:c,shuffle:h,random:a,seed:f,max_grid:r,upextra:i,rules:l});else for(let e=1,n=0;e<=t.z;++e)l.compose({x:1,y:1,z:e,count:++n,grid:t,context:o,rand:u,pick:c,shuffle:h,random:a,seed:f,max_grid:r,rules:l,upextra:i});return l.output()}var er=new Float32Array([-1,-1,1,-1,-1,1,1,1]);function tr(e,t,n){const r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}function nr(e,t,n){const r=document.createElement("canvas"),s=devicePixelRatio||1;let i=r.width=e.width*s,l=r.height=e.height*s;const a=[],o=r.getContext("webgl2",{powerPreference:"high-performance",antialias:!1,failIfMajorPerformanceCaveat:!0,preserveDrawingBuffer:"background"===n});if(!o)return Promise.resolve("");r.loseContext=()=>{const e=o.getExtension("WEBGL_lose_context");e&&e.loseContext()};let u=function(e,t,n){const r=tr(e,e.VERTEX_SHADER,t),s=tr(e,e.FRAGMENT_SHADER,n),i=e.createProgram();return e.attachShader(i,r),e.attachShader(i,s),e.linkProgram(i),e.getProgramParameter(i,e.LINK_STATUS)||(console.warn("Link failed:"+e.getProgramInfoLog(i)),console.warn("vs info-log:"+e.getShaderInfoLog(r)),console.warn("fs info-log:"+e.getShaderInfoLog(s)),e.deleteProgram(i)),e.detachShader(i,r),e.detachShader(i,s),e.deleteShader(r),e.deleteShader(s),i}(o,e.vertex||"#version 300 es\n in vec4 position;void main(){gl_Position = position;}",function(e,t){const n=e.includes("void mainImage"),r=/precision\s+(highp|mediump|lowp)\s+float/.test(e),s=/^\s*out\s+vec4\s+\w+/m.test(e),i=/gl_FragColor\s*=/.test(e),l=/texture2D\s*\(/.test(e),a=["#version 300 es"],o=t=>{e.includes(t)||a.push(t)};return r||o("precision mediump float;"),s||o("out vec4 FragColor;"),o("uniform vec2 u_resolution;"),o("uniform float u_time;"),o("uniform float u_timeDelta;"),o("uniform int u_frameIndex;"),o("uniform vec2 u_seed;"),o("uniform vec2 u_mouse;"),t.forEach((e=>{o(`uniform sampler2D ${e.name};`)})),n&&(o("#define iResolution vec3(u_resolution, 0)"),o("#define iTime u_time"),o("#define iTimeDelta u_timeDelta"),o("#define iFrame u_frameIndex"),o("#define iMouse vec4(u_mouse, 0, 0)"),t.forEach(((e,t)=>{o(`#define iChannel${t} ${e.name}`)}))),i&&o("#define gl_FragColor FragColor"),l&&o("#define texture2D texture"),a.push(e),n&&a.push("void main(){mainImage(FragColor, gl_FragCoord.xy);}"),a.join("\n")}(e.fragment||"",e.textures||[]));const c=o.getAttribLocation(u,"position"),h=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,h),o.bufferData(o.ARRAY_BUFFER,er,o.STATIC_DRAW),o.enableVertexAttribArray(c),o.vertexAttribPointer(c,2,o.FLOAT,!1,0,0),o.viewport(0,0,o.drawingBufferWidth,o.drawingBufferHeight),o.clearColor(0,0,0,0),o.clear(o.COLOR_BUFFER_BIT),o.useProgram(u);const p=o.getUniformLocation(u,"u_resolution");o.uniform2fv(p,[i,l]),e.textures.forEach(((e,t)=>{a.push(function(e,t,n){const r=e.createTexture();return e.activeTexture(e["TEXTURE"+n]),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.bindTexture(e.TEXTURE_2D,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),r}(o,e.value,t)),o.uniform1i(o.getUniformLocation(u,e.name),t)}));const f=o.getUniformLocation(u,"u_seed");f&&o.uniform2f(f,T(t)/1e16,Math.random());const d=o.getUniformLocation(u,"u_time"),m=o.getUniformLocation(u,"u_frameIndex"),g=o.getUniformLocation(u,"u_timeDelta"),v=o.getUniformLocation(u,"u_mouse"),y=d||m||g;let b=0,x=0;return Promise.resolve([(t,n,i,l,u)=>{o.clear(o.COLOR_BUFFER_BIT),e.width===n&&e.height===i||(u.forEach(((e,t)=>{o.bindTexture(o.TEXTURE_2D,a[t]),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,e.value)})),e.width=n,e.height=i,r.width=n*s,r.height=i*s,o.viewport(0,0,r.width,r.height),o.uniform2fv(p,[r.width,r.height])),d&&o.uniform1f(d,.001*t),m&&o.uniform1i(m,b++),v&&o.uniform2f(v,l.x*s,(i-l.y)*s),g&&(o.uniform1f(g,.001*(t-x)),x=t),o.drawArrays(o.TRIANGLE_STRIP,0,4)},y,r])}function rr(e,t){let n=[];for(;e.next();){let{curr:t,next:r}=e.get(),s=!r||t.isSymbol(";")||r.isSymbol("}");if(n.push(t),s)break}return n.length&&(t.value=ir(n)),t}function sr(e,t){let n=[],r=[],s=t&&t.type||"",i=[];for(;e.next();){let{prev:l,curr:a,next:o}=e.get(),u=!o||a.isSymbol("}");if("block"===s&&u){o||!n.length||a.isSymbol("}")||(n[n.length-1].value+=";"+a.value),t.value=n;break}if(a.isSymbol("{")&&r.length&&!i.length){let t=lr(r);if(!t.length)continue;let s=sr(e,{type:"block",name:"unkown",value:[]});t.forEach((e=>{let t=Object.assign({},s,{name:e.name,args:e.args});n.push(t)})),r=[]}else if(a.isSymbol(":")&&r.length&&!i.length){let i=ir(r);n.push(rr(e,{type:"statement",name:i,value:""})),"block"==s&&(t.value=n),r=[]}else a.isSymbol(";")?n.length&&r.length&&(n[n.length-1].value+=";"+ir(r),r=[]):(a.isSymbol("(")&&i.push(a),a.isSymbol(")")&&i.pop(),r.push(a))}return n.length&&"block"==s&&(t.value=n),s?t:n}function ir(e){return e.filter(((t,n)=>!t.isSymbol(";")||n!==e.length-1)).map((e=>e.value)).join("")}function lr(e){let t=r(e),n=[],s="",i=[],l=[],a=[];for(;t.next();){let{curr:e,next:r}=t.get();!s.length&&e.isWord()?s=e.value:e.isSymbol("(")?(a.length&&l.push(e.value),a.push(e)):e.isSymbol(")")?(a.pop(),a.length?l.push(e.value):l.length&&(i.push(l.join("")),l=[])):e.isSymbol(",")?a.length?(i.push(l.join("")),l=[]):(l.length&&(i.push(l.join("")),l=[]),s&&(n.push({name:s,args:i}),s="",i=[],l=[])):l.push(e.value)}return s&&n.push({name:s,args:i}),n.filter(((e,t,n)=>n.findIndex((t=>t.name===e.name&&e.args.join("")==t.args.join("")))===t))}var ar=function(e){return sr(r(p(e)))},or={"(":20,")":20,".":19,"[":19,"!":16,"~":16,"*":14,"/":14,"%":14,"+":13,"-":13,"<<":12,">>":12,"<":11,"<=":11,">":11,">=":11,"\u2264":11,"\u2265":11,"==":10,"!=":10,"=":10,"\u2260":10,"&":9,"^":8,"|":7,"&&":6,"||":5},ur={"=":"==","\u2264":"<=","\u2265":">=","\u2260":"!="},cr=new Set(["<<",">>","==","!=","<=",">=","&&","||"]);function hr(e,{expect:t=null}={}){const n=function(e){const t=[];for(let n=0;n<e.length;n++){const r=e[n];if("Space"===r.type)continue;const s=e[n+1];if(s&&r.isWord()&&s.isNumber())r.value+=s.value,n++,t.push(r);else{if(s){const e=r.value+s.value;if(cr.has(e)){r.value=e,n++,t.push(r);continue}}t.push(r)}}return t}(p(e));let r=0;const s=()=>n[r],i=()=>n[r++];function l(e=0){const t=i();if(!t)return null;let a;if(t.isNumber())a={type:"Lit",val:t.value};else if(t.isWord()){const e=s();a=e&&e.isSymbol("(")?function(e){i();let t=[],n=s();if(n&&")"!==n.value)do{t.push(l()),n=s()}while(n&&","===n.value&&i()&&(n=s()));return i(),{type:"Call",val:e,args:t}}(t.value):{type:"Var",val:t.value}}else"("===t.value?(a=l(),i()):a="!"===t.value?{type:"Pre",val:"!",right:l(16)}:"~"===t.value?{type:"Pre",val:"~",right:l(16)}:"-"===t.value?{type:"Pre",val:"-",right:l(16)}:{type:"Lit",val:"0"};for(;r<n.length;){const t=s();if(!t.isSymbol()||")"===t.value||","===t.value)break;const n=or[t.value];if(!n||n<e)break;i(),a={type:"Bin",val:t.value,left:a,right:l(n+1)}}return a}try{return function e(t,n){if(!t)return"";if("Lit"===t.type)return"bool"===n?`bool(${t.val.includes(".")?t.val:t.val+".0"})`:"int"===n?String(Math.floor(t.val)):t.val.includes(".")?t.val:t.val+".0";if("Var"===t.type)return"int"===n?`int(${t.val})`:t.val;if("Pre"===t.type)return"!"===t.val?`!${e(t.right,"bool")}`:"~"===t.val?`~${e(t.right,"int")}`:`-${e(t.right,n)}`;if("Call"===t.type){let r=t.args.map((t=>e(t,"float"))).join(", ");return"int"===t.val?"float"===n?`float(int(${r}))`:`int(${r})`:"float"===t.val?r:`${t.val}(${r})`}const r=t.val;let s="float",i="float";switch(r){case"%":s="float";break;case"&":case"^":case"|":case"<<":case">>":s=i="int";break;case"&&":case"||":s=i="bool";break;case"==":case"!=":case"=":case"\u2260":case"<":case">":case"<=":case">=":case"\u2264":case"\u2265":s="bool",i="float"}const l=e(t.left,i),a=e(t.right,i),o="%"===r?`mod(${l}, ${a})`:`(${l} ${ur[r]||r} ${a})`;if("bool"===s&&n)return`${n}(${o})`;if(s!==n&&n){if("bool"===n)return`bool(${o})`;if("int"===n)return`int(${o})`;if("float"===n)return`float(${o})`}return o}(l(),t)}catch(t){return console.error(t),e}}var pr="\n vec2 cellUV = fract(uv * v) - 0.5;float dist = length(cellUV);shapeMask = 1.0 - smoothstep(0.5 - fwidth(dist), 0.5, dist);",fr=e=>String(e).includes(".")?e:e+".0",dr={fill(e,t){let{r:n,g:r,b:s,a:i}=t.get_rgba_color(e.value);return{type:"statement",value:`\ncolor = vec4(${fr(n/255)}, ${fr(r/255)}, ${fr(s/255)}, ${fr(i)});`}},grid:e=>({type:"grid",value:e.value}),shape(e,t,n){let r=e.value.trim();return n&&r?{type:"statement",value:"circle"===r?pr:"\nshapeMask = 1.0;"}:{type:"shape",value:r}}};function mr(e,t,n=!1,r={}){let s=dr[e.name];if(s)return s(e,t,n);let i=e.name.startsWith("--")?e.name.slice(2).trim():e.name.trim();return i?{type:"variable",name:i,value:e.value.trim()}:{type:"statement",value:""}}function gr(e,t,n=0,r=null){if(n>10)return e;let s=Object.keys(t).sort(((e,t)=>t.length-e.length));for(let i of s){if(i===r)continue;let s=new RegExp(`\\b${i}\\b`,"g");if(s.test(e)){let r=gr(t[i],t,n+1,i);e=e.replace(s,`(${r})`)}}return e}function vr(e,t,n={}){if("match"!==e.name)return"";return`\n if (${hr(gr(e.args[0],n),{expect:"bool"})}){${e.value.map((e=>mr(e,t,!0,n))).filter((e=>"statement"===e.type)).map((e=>e.value)).join("")}}`}function yr(e,t){let n=ar(e),r=[],s={x:1,y:1},i=null,l={};for(let e of n)if("statement"===e.type){let n=mr(e,t);switch(n.type){case"statement":r.push(n.value);break;case"grid":s=Ce(n.value,1/0);break;case"shape":i=n.value;break;case"variable":l[n.name]=n.value}}else"block"===e.type&&r.push(vr(e,t,l));return function(e,{x:t,y:n},r){return`\n vec3 mapping(vec2 uv, vec2 grid){float x = floor(uv.x * grid.x) + 1.0;float y = floor((1.0 - uv.y) * grid.y) + 1.0;float i = x + (y - 1.0) * grid.x;return vec3(x, y, i);} vec4 getColor(float x, float y, float i, float I, float X, float Y, float t, vec2 uv, vec2 v){vec4 color = vec4(0, 0, 0, 0);float shapeMask = 1.0;${"circle"===r?pr:""} ${e} color.a *= shapeMask;return color;} void main(){vec2 uv = gl_FragCoord.xy/u_resolution.xy;vec2 v = vec2(${t}, ${n});vec3 p = mapping(uv, v);FragColor = getColor(p.x, p.y, p.z, v.x * v.y, v.x, v.y, u_time, uv, v);}`}(r.join(""),s,i)}function br(e,t,n,r){return new Promise(((s,i)=>{let l=`data:image/svg+xml;utf8,${encodeURIComponent(e)}`;function a(){let e=new Image;e.crossOrigin="anonymous",e.src=l,e.onload=()=>{let a=document.createElement("canvas"),o=a.getContext("2d"),u=devicePixelRatio||1;1!=r&&(u=1),a.width=t*u,a.height=n*u,o.drawImage(e,0,0,a.width,a.height);try{a.toBlob((e=>{s({blob:e,source:l,url:URL.createObjectURL(e)})}))}catch(e){i(e)}}}N()?A(l,a,200):a()}))}function xr(e,t=60){let n=null,r=!1,s=1e3/t,i=0,l=0;function a(t){i||(i=t);let r=t-l;l&&(i+=r),r>=s&&(e(i),l=t),n=requestAnimationFrame(a)}return n=requestAnimationFrame(a),{pause(){!r&&n&&(r=!0,cancelAnimationFrame(n),n=null,l=0)},resume(){r&&(r=!1,n=requestAnimationFrame(a))},cancel(){n&&(r=!1,cancelAnimationFrame(n),n=null)}}}function _r(e){if("undefined"==typeof getComputedStyle)return"";let t={};if(e.computedStyleMap)for(let[n,r]of e.computedStyleMap())n.startsWith("--")&&(t[n]=r[0][0]);else{let n=getComputedStyle(e);for(let e of n)e.startsWith("--")&&(t[e]=n.getPropertyValue(e))}return function(e){let t=[];for(let[n,r]of Object.entries(e))t.push(n+":"+r);return t.join(";")}(t)}var $r=new Map,kr=new Set;function wr(e){return Array.isArray(e)||(e=[e]),`https://fonts.googleapis.com/css?display=swap&${e.map((e=>`family=${encodeURIComponent(e)}`)).join("&")}`}function Sr(e){let t=[];if(Array.isArray(e)){for(let n of e)kr.has(n)||(kr.add(n),t.push(n));if(t.length&&"undefined"!=typeof document){let e=document.createElement("link");e.rel="stylesheet",e.href=wr(t),document.head.appendChild(e)}}}async function jr(e=Array.from(kr)){if(!Array.isArray(e)||!e.length)return"";let t=e.filter((function(e,t,n){return n.indexOf(e)===t}));if(!t.length)return"";try{let e=await async function(e){let t=await fetch(wr(e));if(!t.ok)throw new Error(`Failed to fetch fonts:${t.status}`);return t.text()}(t),n=function(e){let t,n=/@font-face\s*{([^}]+)}/gi,r=[],s=new Set;for(;null!==(t=n.exec(e));){let e=t[1],n=t=>{let n=new RegExp(`${t}:\\s*['"]?([^'";\\)]+)['"]?`,"i"),r=e.match(n);return r?r[1].trim():null},i=e.match(/url\(([^)]+)\)/i),l=i?i[1].replace(/['"]/g,""):null,a=n("font-family");a&&l&&!s.has(l)&&(s.add(l),r.push({family:a,url:l,weight:n("font-weight")||"400",style:n("font-style")||"normal"}))}if(!r.length)throw new Error("No fonts found in CSS");return r}(e);return(await Promise.all(n.map((async({family:e,url:t})=>{let n=await async function(e){let t=$r.get(e);if(t)return t;let n=await fetch(e);if(!n.ok)throw new Error(`Failed to fetch font (${n.status}):${e}`);let r=await n.blob(),s=await new Promise(((e,t)=>{let n=new FileReader;n.onloadend=()=>{let t=n.result.split(",")[1];e(t)},n.onerror=t,n.readAsDataURL(r)}));return $r.set(e,s),s}(t);return`@font-face{font-family:"${e}";src:url("data:font/woff2;base64,${n}") format("woff2");}`})))).join("\n")}catch(e){return console.warn("Error loading fonts:",e),""}}var Ar={CSSDoodle:class{},define(e,t){"undefined"==typeof customElements||customElements.get(e)||customElements.define(e,t)}};function Nr(e){let{x:t,y:n}=e||{};return`\n *,*::after,*::before,:host,.host{box-sizing:border-box;}:host,.host{display:block;visibility:visible;width:fit-content;height:fit-content;contain:content;view-transition-name:css-doodle;--${Lt.name}:0;--${Ut.name}:0\n}:host([hidden]),[hidden]{display:none\n}:host([cssd-paused]),\n:host([cssd-paused]) *{animation-play-state:paused !important\n} grid, cell{display:grid;position:relative;} grid{gap:inherit;grid-template:repeat(${n},1fr)/repeat(${t},1fr)\n} b{position:absolute;inset:0;pointer-events:none;} cell{place-items:center;min-height:0;min-width:0;} svg, canvas{position:absolute;} grid, svg, canvas{width:100%;height:100%\n} canvas{object-fit:cover;}`}function Er(e,t,n,r,s=""){let i=S(e,t,n),l=s??"",a=r["#"+i]??"";return a.startsWith("${shader")&&(a=""),`<cell id="${i}" part="cell">${a}${l}</cell>`}function Tr(e,t){let{x:n,y:r,z:s}=e||{},{content:i,styles:l}=t,a="";if(1==s)for(let e=1;e<=r;++e)for(let t=1;t<=n;++t)a+=Er(t,e,1,i);else{let e="";for(let t=s;t>=1;t--){e=Er(1,1,t,i,e)}a=e}let o=`<grid part="grid">${a}</grid>`;return l.backdrop&&(o+="<b></b>"),o}"undefined"!=typeof HTMLElement&&(Ar.CSSDoodle=class extends HTMLElement{static observedAttributes=["grid","seed","use","experimental","click-to-update","click:update","auto:update"];constructor(){super(),this.doodle=this.attachShadow({mode:"open"}),this.animations=[],this.observers=new Map,this.shader_renders=new Map,this.extra={get_variable:e=>function(e,t){return"undefined"==typeof getComputedStyle?"":getComputedStyle(e).getPropertyValue(t).trim().replace(/^\(|\)$/g,"")}(this,e),get_rgba_color:e=>function(e,t){let n=e.querySelector("style");return n?(n.style.color=t,function(e){let[t,n,r,s=1]=e.replace(/rgba?\((.+)\)/,((e,t)=>t)).split(/,\s*/);return{r:t,g:n,b:r,a:s}}(getComputedStyle(n).color)):{r:0,g:0,b:0,a:1}}(this.shadowRoot,e)}}connectedCallback(e){this.innerHTML?(this.load(e),this._rendering=!0):setTimeout((()=>{this.load(e),this._rendering=!0}))}disconnectedCallback(){this.cleanup()}triggerEvent(e,t={}){return this.dispatchEvent(new CustomEvent(e,{detail:t,bubbles:!0,composed:!0}))}_update(e){this.cleanup(),e||(e=E(this._code)),this._code!==e&&(this._code=e),this.grid_size||(this.grid_size=this.get_grid());const{x:t,y:n,z:r}=this.grid_size,s=this.get_use();let i="",l={};this.compiled&&(i=this.compiled.content,l=this.compiled.styles);const a=this.generate(Te(s+e,this.extra));let o=a.grid||this.get_grid(),{x:u,y:c,z:h}=o,p=!this.shadowRoot.innerHTML||this.shadowRoot.querySelector("css-doodle")||t!==u||n!==c||r!==h||JSON.stringify(i)!==JSON.stringify(a.content)||!l.cells||!a.styles.cells||l.backdrop!==a.styles.backdrop;if(Object.assign(this.grid_size,o),p)a.grid?this.build_grid(a,o):this.build_grid(this.generate(Te(s+e,this.extra)),o);else{this.bind_uniforms(a.uniforms);let e=this.replace(a);a.props.has_animation&&(this.set_style(l.all.replace(/animation/g,"x")),this.reflow()),a.styles.gf&&Sr(a.styles.gf),this.set_style(e(a.styles.top+Nr(this.grid_size)+a.styles.all))}setTimeout((()=>{this.triggerEvent("render"),this.triggerEvent("afterUpdate"),this.triggerEvent("update")}))}update(e,t={}){if(this.triggerEvent("beforeUpdate"),!document.startViewTransition)return this._update(e);arguments.length||(e="",t={}),"object"==typeof e&&(t=e,e="");let n=this.viewTransition;void 0===n&&(n=this.hasAttribute("view-transition")),n?document.startViewTransition((()=>{this._update(e)})):this._update(e),t.auto||!this.hasAttribute("auto:update")&&!this._auto_update_timer||this.autoUpdate()}pause(){this.setAttribute("cssd-paused",!0);for(let e of this.animations)e.pause()}resume(){this.removeAttribute("cssd-paused");for(let e of this.animations)e.resume()}export({scale:e,name:t,download:n,detail:r}={}){return new Promise((async(s,i)=>{let l=_r(this),a=this.doodle.innerHTML,{width:o,height:u}=this.getBoundingClientRect(),c=o*(e=parseInt(e)||1),h=u*e,p=await jr(),f=`\n<svg ${Ue} preserveAspectRatio="none" viewBox="0 0 ${o} ${u}" ${N()?"":`width="${c}px" height="${h}px"`}><foreignObject width="100%" height="100%"><div class="host" ${De} style="width:${o}px;height:${u}px"><style><![CDATA[\n ${p} .host{${l}} ]]></style>${a}</div></foreignObject></svg>`;n||r?br(f,c,h,e).then((({source:e,url:r,blob:i})=>{if(s({width:c,height:h,svg:f,blob:i,source:e}),n){let e=document.createElement("a");e.download=function(e){return(_(e)?Date.now():String(e).replace(/\/.png$/g,""))+".png"}(t),e.href=r,e.click()}})).catch((e=>{i(e)})):s({width:c,height:h,svg:f})}))}get grid(){return Object.assign({},this.grid_size)}set grid(e){this.attr("grid",e)}get seed(){return this._seed_value}set seed(e){this.attr("seed",e)}get use(){return this.attr("use")}set use(e){this.attr("use",e)}attributeChangedCallback(e,t,n){t!==n&&Ar.CSSDoodle.observedAttributes.includes(e)&&("click-to-update"===e||"click:update"===e?null===n?(this.removeEventListener("click",this.bindClickToUpdate),this.removeAttribute("click-to-update"),this.removeAttribute("click:update")):null===t&&this.addEventListener("click",this.bindClickToUpdate):"auto:update"===e?null!==n?this.autoUpdate():this.cancelAutoUpdate():this.connectedCallback(!0))}get_max_grid(){return this.hasAttribute("experimental")?256:64}get_grid(){return Ce(this.attr("grid"),this.get_max_grid())}_get_auto_update_interval(e){return _(e)&&(e=this.dataset.interval||this.attr("auto:update")||2e3),e=String(e).trim(),e=/^([\d.]+)m$/.test(e)?60*parseFloat(e)*1e3:/^([\d.]+)s$/.test(e)?1e3*parseFloat(e):parseFloat(e),isNaN(e)?2e3:Math.max(e,500)}autoUpdate(e){clearInterval(this._auto_update_timer),_(e)||(this.dataset.interval=e),this._auto_update_timer=setInterval((()=>this.update({auto:!0})),this._get_auto_update_interval(e))}cancelAutoUpdate(e={}){clearInterval(this._auto_update_timer),this._auto_update_timer=null,this.removeAttribute("auto:update"),this.removeAttribute("data-interval")}get_use(){let e=String(this.attr("use")||"").trim();return/^var\(/.test(e)&&(e=`@use:${e};`),e}cleanup(){if(nt.clear(),this.compiled){for(let e of this.animations)e.cancel();this.animations=[];let{pattern:e,shaders:t}=this.compiled;if(Object.keys(e).length||Object.keys(t).length){for(let e of this.shadowRoot.querySelectorAll("cell"))e.style.cssText="";this.observers.forEach(((e,t)=>{e.disconnect()}))}}this.observers.clear(),this.shader_renders.forEach((({canvas:e})=>{e&&e.loseContext&&e.loseContext()})),this.shader_renders.clear(),this.style.background=""}attr(e,t){let n=arguments.length;return 1===n?this.getAttribute(e):2===n?(this.setAttribute(e,t),t):void 0}generate(e){let t=this.get_grid(),n=this.attr("seed")||this.attr("data-seed");_(n)&&(n=Date.now());let r=this.compiled=Qn(e,t,n,this.get_max_grid());return this._seed_value=r.seed,this._seed_random=r.random,r}doodle_to_image(e,t,n){"function"==typeof t&&(n=t,t=null);let r=Te(e=":doodle{width:100%;height:100%}"+e,this.extra),s=Ce(""),i=Qn(r,s,this._seed_value,this.get_max_grid(),this._seed_random,t.upextra),l=i.styles||{},a=i.grid?i.grid:s,o="";if(t&&t.arg){let e=Ce(t.arg,1/0);e.x&&e.y&&(t.width=e.x+"px",t.height=e.y+"px",o=`viewBox="0 0 ${e.x} ${e.y}"`)}let u=this.replace(i),c=Tr(a,i),h=t&&t.width&&t.height?`width="${t.width}" height="${t.height}"`:"";jr(l.gf||[]).then((e=>{u(`\n<svg ${h} ${Ue} preserveAspectRatio="none" ${o}><foreignObject width="100%" height="100%"><div class="host" width="100%" height="100%" ${De}><style><![CDATA[\n ${e} ${l.top} @property --${Lt.name}{syntax:"<integer>";initial-value:0;inherits:true;} @property --${Ut.name}{syntax:"<integer>";initial-value:0;inherits:true;} ${Nr(a)} ${l.all} ]]></style>${c}</div></foreignObject></svg>`).then((e=>{let r=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(e)))}`;N()?h?br(e,parseInt(t.width),parseInt(t.height),devicePixelRatio||2).then((({blob:e})=>{let t=URL.createObjectURL(e);A(t),n(t)})):(A(r),n(r)):n(r)}))}))}pattern_to_image({code:e,cell:t,id:n,arg:r,target:s},i){let l=yr(e,this.extra);this.shader_to_image({shader:l,cell:t,id:n,arg:r,target:s},i)}shader_to_image({shader:e,cell:t,id:n,arg:r,target:s},i){let l;l=":host"===s.selector?this:":container"===s.selector?this.shadowRoot.querySelector("grid"):this.doodle.getElementById(t);let a,{width:o,height:u}=l.getBoundingClientRect();r&&(a=Ce(r,1/0),a.x&&a.y&&(o=Math.min(a.x,o),u=Math.min(a.y,u)));let c=this.seed,h="string"==typeof e?Oe(e):e;h.width=o,h.height=u;let p=h.textures,f=[];const d=e=>{l.style.setProperty("background",'url("'+e+'") no-repeat 50%/cover')},m=([e,t,n])=>{if("content"===s.type)e(0,o,u,this._umouse,f),l.replaceChildren(n),t?this.animations.push(xr((t=>{e(t,o,u,this._umouse,f)}))):this.shader_renders.has(s.selector)||this.shader_renders.set(s.selector,{render:e,canvas:n});else if(t)this.animations.push(xr((t=>{e(t,o,u,this._umouse,f),d(n.toDataURL())})));else{this.shader_renders.get(s.selector)||this.shader_renders.set(s.selector,{render:e,canvas:n}),e(0,o,u,this._umouse,f),d(n.toDataURL())}},g=(e,t)=>{let n=devicePixelRatio||1;Promise.all(e.map((({name:e,value:t})=>new Promise((r=>{this.doodle_to_image(t,{width:o,height:u},(t=>{let s=new Image;s.width=o*n,s.height=u*n,s.onload=()=>r({name:e,value:s}),s.src=t}))}))))).then(t)};if(!this.observers.has(s.selector)){let e=new ResizeObserver(function(e,t=100){let n;return(...r)=>{clearTimeout(n),n=setTimeout((()=>e(...r)),t)}}((()=>{let e=l.getBoundingClientRect();o=e.width,u=e.height,a&&a.x&&a.y&&(o=Math.min(a.x,o),u=Math.min(a.y,u)),g(p,(e=>{f=e;let t=this.shader_renders.get(s.selector);t&&(t.render(0,o,u,this._umouse,f),"background"===s.type&&d(t.canvas.toDataURL()))}))})));e.observe(l),this.observers.set(s.selector,e)}p.length?g(p,(e=>{h.textures=f=e,h.width=o,h.height=u,nr(h,c,s.type).then(m).then(i)})):nr(h,c,s.type).then(m).then(i)}bindClickToUpdate(){this.update()}load(e){if(this._rendering)return!1;this.cleanup();let t=this._code||this.innerHTML,n=Te(this.get_use()+E(t),this.extra),r=this.generate(n);e||(this.hasAttribute("click-to-update")||this.hasAttribute("click:update"))&&this.addEventListener("click",this.bindClickToUpdate),this.grid_size=r.grid?r.grid:this.get_grid(),this.build_grid(r,this.grid_size),this._code=t,this.innerHTML="",setTimeout((()=>{this._rendering=!1,this.triggerEvent("render")}))}replace({doodles:e,shaders:t,pattern:n}){let r=Object.keys(e),s=Object.keys(t),i=Object.keys(n),l=r.length+s.length+i.length;return a=>{if(!l)return Promise.resolve(a);let o=[].concat(r.map((t=>a.includes(t)?new Promise((n=>{let{arg:r,doodle:s,upextra:i}=e[t];this.doodle_to_image(s,{arg:r,upextra:i},(e=>n({id:t,value:e})))})):Promise.resolve(""))),s.map((e=>a.includes(e)?new Promise((n=>{this.shader_to_image(t[e],(t=>n({id:e,value:t})))})):Promise.resolve(""))),i.map((e=>a.includes(e)?new Promise((t=>{this.pattern_to_image(n[e],(n=>t({id:e,value:n})))})):Promise.resolve(""))));return Promise.all(o).then((e=>{for(let{id:t,value:n}of e){let e=`url(${n})`;/^shader|^pattern/.test(t)&&(e=`var(--${t})`),a=a.replaceAll("${"+t+"}",e)}return a}))}}reflow(){this.shadowRoot.querySelector("grid").offsetWidth}bind_uniforms({time:e,mousex:t,mousey:n,mouse:r,width:s,height:i}){e&&this.reg_utime(),t||n||r?this.reg_umouse(t,n,r):this.off_umouse(),s||i?this.reg_usize(s,i):this.off_usize()}build_grid(e,t){const{has_transition:n,has_animation:r}=e.props,{uniforms:s,content:i,styles:l}=e;let a=n||r,o=Object.keys(i).length;this.doodle.innerHTML=`\n<style>${Nr(t)+l.main}</style>${l.cells||l.container||o?Tr(t,e):""}`,a&&this.reflow();let u=this.replace(e);this.set_style(u(l.top+Nr(t)+l.all)),l.gf&&Sr(l.gf),o&&u(Object.values(e.content).join(" ")),this.bind_uniforms(s)}reg_umouse(e,t,n){if(this.umouse_fn)e||t||n||this.off_umouse();else{this.umouse_fn=r=>{let s=r.detail||r;n&&(this._umouse={x:s.offsetX,y:s.offsetY}),(e||t)&&(this.style.setProperty("--"+Dt,s.offsetX),this.style.setProperty("--"+Ft,s.offsetY))},this.addEventListener("pointermove",this.umouse_fn);let r=new CustomEvent("pointermove",{detail:{offsetX:0,offsetY:0}});this.dispatchEvent(r)}}off_umouse(){this.umouse_fn&&(this.style.removeProperty("--"+Dt),this.style.removeProperty("--"+Ft),this.removeEventListener("pointermove",this.umouse_fn),this.umouse_fn=null,delete this._umouse)}reg_usize(e,t){this.usize_observer?e||t||this.off_usize():(this.usize_observer=new ResizeObserver((()=>{let n=this.getBoundingClientRect();(e||t)&&(this.style.setProperty("--"+Bt,n.width),this.style.setProperty("--"+Xt,n.height))})),this.usize_observer.observe(this))}off_usize(){this.usize_observer&&(this.style.removeProperty("--"+Bt),this.style.removeProperty("--"+Xt),this.usize_observer.unobserve(this),this.usize_observer=null)}reg_utime(){if(!this.is_utime_set){try{CSS.registerProperty({name:"--"+Lt.name,syntax:"<integer>",initialValue:0,inherits:!0}),CSS.registerProperty({name:"--"+Ut.name,syntax:"<integer>",initialValue:0,inherits:!0})}catch(e){}this.is_utime_set=!0}}set_style(e){if(e instanceof Promise)e.then((e=>{this.set_style(e)}));else{const t=this.shadowRoot.querySelector("style");t&&(t.textContent=e.replace(/\n\s+/g," "))}}});var Cr=Ar.CSSDoodle;(0,Ar.define)("css-doodle",Cr)})();