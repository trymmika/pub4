<!DOCTYPE html>
<html><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Backlight Orb</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
html,body{height:100%;overflow:hidden}
body{display:flex;align-items:center;justify-content:center;width:100%;height:100vh;background-color:var(--background,#20293a);transition:background-color 1s}
.mood-neutral{--background:#20293a;--color1:#00fcbd;--color2:#7400f9}
.mood-positive{--background:#203a29;--color1:#00fc7d;--color2:#00f974}
.mood-negative{--background:#3a2020;--color1:#fc0000;--color2:#f97400}
.mood-calm{--background:#202a3a;--color1:#0074fc;--color2:#0000f9}
.mood-excited{--background:#3a203a;--color1:#fc00fc;--color2:#f900f9}
.orb{position:relative;display:flex;align-items:center;justify-content:center;width:300px;height:300px;background-color:var(--background);border-radius:50%;transition:transform 0.1s,color 10s}
.orb::after{position:absolute;content:"";top:-5%;left:-5%;right:0;z-index:-1;height:100%;width:100%;margin:0 auto;transform:scale(0.85);filter:blur(5vw);background:linear-gradient(270deg,var(--color1),var(--color2));background-size:150% 150%;border-radius:50%;animation:glowmation 10s linear infinite}
@keyframes glowmation{
  0%{top:-3%;left:-3%;background-position:0% 50%;background-size:150% 150%}
  12.5%{top:-3%;left:0;background-size:70% 30%}
  25%{top:-3%;left:3%;background-size:100% 50%}
  37.5%{top:0;left:3%;background-size:70% 30%}
  50%{top:3%;left:3%;background-position:100% 50%;background-size:30% 30%}
  62.5%{top:3%;left:0;background-size:30% 70%}
  75%{top:3%;left:-3%;background-size:50% 100%}
  87.5%{top:0;left:-3%;background-size:30% 70%}
  100%{top:-3%;left:-3%;background-position:0% 50%;background-size:150% 150%}
}
</style>
</head>
<body class="mood-neutral">
<div class="orb" id="orb"></div>
<script>
var orb=document.getElementById('orb'),audio=0,mx=0,my=0,gx=0,gy=0;
document.addEventListener('mousemove',function(e){
  mx=(e.clientX/window.innerWidth-0.5)*30;
  my=(e.clientY/window.innerHeight-0.5)*30;
});
window.addEventListener('deviceorientation',function(e){
  if(e.gamma!==null){gx=e.gamma*0.5;gy=(e.beta-45)*0.5}
});
navigator.mediaDevices.getUserMedia({audio:true}).then(function(stream){
  var context=new AudioContext(),source=context.createMediaStreamSource(stream),analyser=context.createAnalyser();
  analyser.fftSize=256;source.connect(analyser);
  var data=new Uint8Array(analyser.frequencyBinCount);
  (function loop(){
    analyser.getByteFrequencyData(data);
    var sum=0;for(var i=0;i<50;i++)sum+=data[i];
    audio=sum/50/255;
    requestAnimationFrame(loop);
  })();
}).catch(function(){});
(function frame(){
  var scale=1+audio*0.2;
  var translateX=mx||gx,translateY=my||gy;
  orb.style.transform='translate('+translateX+'px,'+translateY+'px) scale('+scale+')';
  requestAnimationFrame(frame);
})();
var mood=new URLSearchParams(location.search).get('mood')||'neutral';
document.body.className='mood-'+mood;
window.addEventListener('message',function(event){
  if(event.data&&event.data.mood)document.body.className='mood-'+event.data.mood;
});
</script>
</body>
</html>
