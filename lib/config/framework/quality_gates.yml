# Quality Gates Configuration
# Defines quality checkpoints, thresholds, and enforcement policies

gates:
  - name: test_coverage
    description: Code coverage requirements
    enabled: true
    enforcement: block
    priority: high
    checks:
      - name: minimum_line_coverage
        type: minimum
        metric: line_coverage
        threshold: 80.0
        severity: error
        description: Minimum 80% line coverage required

      - name: minimum_branch_coverage
        type: minimum
        metric: branch_coverage
        threshold: 70.0
        severity: warning
        description: Minimum 70% branch coverage recommended

      - name: minimum_function_coverage
        type: minimum
        metric: function_coverage
        threshold: 85.0
        severity: warning
        description: Minimum 85% function coverage recommended

      - name: no_coverage_regression
        type: minimum
        metric: coverage_delta
        threshold: 0.0
        severity: warning
        description: Coverage should not decrease

  - name: tests
    description: Test execution requirements
    enabled: true
    enforcement: block
    priority: critical
    checks:
      - name: all_tests_pass
        type: exact
        metric: tests_failed
        threshold: 0
        severity: error
        description: All tests must pass

      - name: no_skipped_tests
        type: exact
        metric: tests_skipped
        threshold: 0
        severity: warning
        description: No skipped tests allowed in production

      - name: minimum_test_count
        type: minimum
        metric: tests_total
        threshold: 1
        severity: error
        description: At least one test required

      - name: minimum_pass_rate
        type: minimum
        metric: pass_rate
        threshold: 95.0
        severity: warning
        description: At least 95% tests should pass

      - name: test_execution_time
        type: maximum
        metric: test_duration
        threshold: 300
        severity: info
        description: Tests should complete within 5 minutes

  - name: complexity
    description: Code complexity limits
    enabled: true
    enforcement: warn
    priority: medium
    checks:
      - name: max_cyclomatic_complexity
        type: maximum
        metric: cyclomatic_complexity
        threshold: 10
        severity: warning
        description: Maximum cyclomatic complexity of 10

      - name: max_cognitive_complexity
        type: maximum
        metric: cognitive_complexity
        threshold: 15
        severity: warning
        description: Maximum cognitive complexity of 15

      - name: max_method_complexity
        type: maximum
        metric: max_method_complexity
        threshold: 20
        severity: error
        description: No method should exceed complexity of 20

      - name: max_nesting_depth
        type: maximum
        metric: max_nesting_depth
        threshold: 4
        severity: warning
        description: Maximum nesting depth of 4 levels

      - name: max_method_length
        type: maximum
        metric: max_method_length
        threshold: 50
        severity: info
        description: Methods should not exceed 50 lines

  - name: security
    description: Security vulnerability checks
    enabled: true
    enforcement: block
    priority: critical
    checks:
      - name: no_critical_vulnerabilities
        type: exact
        metric: critical_vulnerabilities
        threshold: 0
        severity: error
        description: No critical security vulnerabilities allowed

      - name: no_high_vulnerabilities
        type: exact
        metric: high_vulnerabilities
        threshold: 0
        severity: error
        description: No high security vulnerabilities allowed

      - name: max_medium_vulnerabilities
        type: maximum
        metric: medium_vulnerabilities
        threshold: 5
        severity: warning
        description: Maximum 5 medium vulnerabilities allowed

      - name: max_low_vulnerabilities
        type: maximum
        metric: low_vulnerabilities
        threshold: 10
        severity: info
        description: Maximum 10 low vulnerabilities allowed

      - name: dependency_scan_complete
        type: boolean
        metric: dependency_scan_complete
        threshold: true
        severity: error
        description: Dependency security scan must complete

  - name: code_quality
    description: General code quality metrics
    enabled: true
    enforcement: warn
    priority: medium
    checks:
      - name: max_duplication
        type: maximum
        metric: code_duplication
        threshold: 5.0
        severity: warning
        description: Maximum 5% code duplication

      - name: min_maintainability_index
        type: minimum
        metric: maintainability_index
        threshold: 70
        severity: warning
        description: Maintainability index should be at least 70

      - name: max_technical_debt
        type: maximum
        metric: technical_debt_hours
        threshold: 40
        severity: info
        description: Technical debt should not exceed 40 hours

      - name: max_code_smells
        type: maximum
        metric: code_smells
        threshold: 20
        severity: warning
        description: Maximum 20 code smells allowed

  - name: performance
    description: Performance benchmarks
    enabled: false
    enforcement: warn
    priority: medium
    checks:
      - name: max_response_time
        type: maximum
        metric: response_time
        threshold: 200
        severity: warning
        description: Maximum response time of 200ms

      - name: min_throughput
        type: minimum
        metric: throughput
        threshold: 100
        severity: warning
        description: Minimum throughput of 100 req/sec

      - name: max_error_rate
        type: maximum
        metric: error_rate
        threshold: 1.0
        severity: error
        description: Maximum 1% error rate

      - name: max_memory_usage
        type: maximum
        metric: memory_usage_mb
        threshold: 512
        severity: warning
        description: Maximum 512MB memory usage

      - name: max_cpu_usage
        type: maximum
        metric: cpu_usage_percent
        threshold: 80
        severity: warning
        description: Maximum 80% CPU usage

  - name: documentation
    description: Documentation requirements
    enabled: true
    enforcement: warn
    priority: low
    checks:
      - name: api_documentation_coverage
        type: minimum
        metric: api_doc_coverage
        threshold: 80.0
        severity: info
        description: 80% of public APIs should be documented

      - name: readme_exists
        type: boolean
        metric: has_readme
        threshold: true
        severity: warning
        description: README file must exist

      - name: changelog_updated
        type: boolean
        metric: changelog_updated
        threshold: true
        severity: info
        description: CHANGELOG should be updated

  - name: style_compliance
    description: Code style compliance
    enabled: true
    enforcement: warn
    priority: low
    checks:
      - name: max_style_violations
        type: maximum
        metric: style_violations
        threshold: 10
        severity: warning
        description: Maximum 10 style violations

      - name: formatting_compliant
        type: boolean
        metric: formatting_compliant
        threshold: true
        severity: info
        description: Code should follow formatting standards

  - name: dependency_health
    description: Dependency health checks
    enabled: true
    enforcement: warn
    priority: medium
    checks:
      - name: no_outdated_critical_deps
        type: exact
        metric: outdated_critical_dependencies
        threshold: 0
        severity: error
        description: No critically outdated dependencies

      - name: max_outdated_deps
        type: maximum
        metric: outdated_dependencies
        threshold: 5
        severity: warning
        description: Maximum 5 outdated dependencies

      - name: license_compliance
        type: boolean
        metric: license_compliant
        threshold: true
        severity: error
        description: All dependencies must have compliant licenses

  - name: build
    description: Build process requirements
    enabled: true
    enforcement: block
    priority: high
    checks:
      - name: build_successful
        type: boolean
        metric: build_success
        threshold: true
        severity: error
        description: Build must succeed

      - name: no_build_warnings
        type: exact
        metric: build_warnings
        threshold: 0
        severity: info
        description: Build should have no warnings

      - name: max_build_time
        type: maximum
        metric: build_time_seconds
        threshold: 600
        severity: warning
        description: Build should complete within 10 minutes

settings:
  fail_fast: false
  parallel_checks: true
  cache_results: true
  result_retention_days: 30
  notification_on_failure: true
  auto_retry_transient_failures: true
  max_retries: 2
  retry_delay_seconds: 30
  exemptions_allowed: true
  exemption_approval_required: true
