# Principle Enforcement Configuration
# Maps principles to automated checks, severity levels, and auto-fix capabilities
---
version: 1
enforcement:
  enabled: true
  auto_fix: false  # Set to true to enable automatic fixes
  severity_threshold: medium  # Minimum severity to enforce: low, medium, high, critical

principles:
  01-kiss:
    checks:
      - type: complexity
        metric: cyclomatic
        threshold: 10
        severity: high
      - type: file_size
        threshold: 20480  # 20KB
        severity: medium
      - type: method_length
        threshold: 20
        severity: medium
    auto_fix: false
    
  02-dry:
    checks:
      - type: duplication
        tool: flay
        threshold: 0.05  # 5% duplication
        severity: high
      - type: pattern
        regex: '(\w+\s*=\s*.+\n){3,}.*\1'
        message: "Repeated assignment patterns detected"
        severity: medium
    auto_fix: false
    
  05-single-responsibility:
    checks:
      - type: class_methods
        threshold: 15
        severity: high
      - type: dependencies
        threshold: 5
        severity: medium
    auto_fix: false
    
  10-law-of-demeter:
    checks:
      - type: pattern
        regex: '\w+\.\w+\.\w+\('
        message: "Possible Law of Demeter violation (chaining)"
        severity: low
    auto_fix: false
    
  12-fail-fast:
    checks:
      - type: guard_clauses
        minimum: 1
        severity: low
      - type: pattern
        regex: 'def\s+\w+.*\n\s+if\s+.*\n(\s+.*\n){5,}\s+end\s+end'
        message: "Deep nesting without guard clauses"
        severity: medium
    auto_fix: false
    
  21-explicit-over-implicit:
    checks:
      - type: pattern
        regex: '(send|public_send|method_missing|const_missing)'
        message: "Dynamic dispatch may hide intent"
        severity: low
    auto_fix: false
    
  25-meaningful-names:
    checks:
      - type: pattern
        regex: '\b(tmp|temp|data|obj|thing|stuff)\b'
        message: "Generic variable name detected"
        severity: low
      - type: abbreviations
        severity: medium
    auto_fix: false
    
  26-small-functions:
    checks:
      - type: method_length
        threshold: 20
        severity: high
      - type: parameter_count
        threshold: 4
        severity: medium
    auto_fix: false
    
  29-immutability:
    checks:
      - type: pattern
        regex: '\.freeze'
        inverse: true
        message: "Consider freezing constants"
        severity: low
    auto_fix: false
    
  30-pure-functions:
    checks:
      - type: side_effects
        patterns:
          - 'puts|print|p\s'
          - 'File\.(write|open|delete)'
          - 'Dir\.(mkdir|delete)'
        severity: low
    auto_fix: false

tools:
  rubocop:
    enabled: true
    config: .rubocop.yml
  reek:
    enabled: true
  flay:
    enabled: true
  flog:
    enabled: true
  
reporting:
  format: text  # text, json, html
  output: STDOUT
  include_suggestions: true
  include_examples: true
